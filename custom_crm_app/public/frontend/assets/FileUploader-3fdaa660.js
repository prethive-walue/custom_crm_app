import{F as r}from"./fileUploadHandler-0b2042a3.js";import{_ as n,r as p,b as d,c as u,e as h,z as c,d as f,w as g,Q as m,t as F,O as _,P as y}from"./index-a3e8239b.js";const S={name:"FileUploader",props:{fileTypes:{type:[String,Array]},uploadArgs:{type:Object},validateFile:{type:Function,default:null}},data(){return{uploader:null,uploading:!1,uploaded:0,error:null,message:"",total:0,file:null,finishedUploading:!1}},computed:{progress(){let s=Math.floor(this.uploaded/this.total*100);return isNaN(s)?0:s},success(){return this.finishedUploading&&!this.error}},methods:{inputRef(){return this.$refs.input},openFileSelector(){this.$refs.input.click()},async onFileAdd(s){if(this.error=null,this.file=s.target.files[0],this.file&&this.validateFile)try{let e=await this.validateFile(this.file);e&&(this.error=e)}catch(e){this.error=e}this.error||this.uploadFile(this.file)},async uploadFile(s){this.error=null,this.uploaded=0,this.total=0,this.uploader=new r,this.uploader.on("start",()=>{this.uploading=!0}),this.uploader.on("progress",e=>{this.uploaded=e.uploaded,this.total=e.total}),this.uploader.on("error",()=>{this.uploading=!1,this.error="Error Uploading File"}),this.uploader.on("finish",()=>{this.uploading=!1,this.finishedUploading=!0}),this.uploader.upload(s,this.uploadArgs||{}).then(e=>{this.$emit("success",e)}).catch(e=>{this.uploading=!1;let t="Error Uploading File";e!=null&&e._server_messages?t=JSON.parse(JSON.parse(e._server_messages)[0]).message:e!=null&&e.exc&&(t=JSON.parse(e.exc)[0].split(`
`).slice(-2,-1)[0]),this.error=t,this.$emit("failure",e)})}},expose:["inputRef"]},U=["accept"];function v(s,e,t,N,l,i){const a=p("Button");return d(),u("div",null,[h("input",{ref:"input",type:"file",accept:t.fileTypes,class:"hidden",onChange:e[0]||(e[0]=(...o)=>i.onFileAdd&&i.onFileAdd(...o))},null,40,U),c(s.$slots,"default",_(y({file:l.file,uploading:l.uploading,progress:i.progress,uploaded:l.uploaded,message:l.message,error:l.error,total:l.total,success:i.success,openFileSelector:i.openFileSelector})),()=>[f(a,{onClick:i.openFileSelector,loading:l.uploading},{default:g(()=>[m(F(l.uploading?`Uploading ${i.progress}%`:"Upload File"),1)]),_:1},8,["onClick","loading"])])])}const k=n(S,[["render",v]]);export{k as F};
//# sourceMappingURL=FileUploader-3fdaa660.js.map
