{"version":3,"file":"DataImport-fb969f95.js","sources":["../../../../frontend/node_modules/frappe-ui/frappe/Link/Link.vue","../../../../frontend/node_modules/frappe-ui/frappe/DataImport/dataImport.ts","../../../../frontend/node_modules/frappe-ui/frappe/DataImport/DataImportList.vue","../../../../frontend/node_modules/frappe-ui/frappe/DataImport/ImportSteps.vue","../../../../frontend/node_modules/frappe-ui/frappe/DataImport/MappingStep.vue","../../../../frontend/node_modules/frappe-ui/frappe/DataImport/PreviewStep.vue","../../../../frontend/node_modules/frappe-ui/frappe/DataImport/TemplateModal.vue","../../../../frontend/node_modules/frappe-ui/frappe/DataImport/UploadStep.vue","../../../../frontend/node_modules/frappe-ui/frappe/DataImport/DataImport.vue","../../../../frontend/src/pages/DataImport.vue"],"sourcesContent":["<template>\n  <div class=\"flex flex-col gap-1.5\" :class=\"attrs.class\" :style=\"attrs.style\">\n    <FormLabel v-if=\"label\" :label=\"label\" size=\"sm\" :required=\"required\" />\n    <Combobox\n      v-model=\"model\"\n      :placeholder=\"placeholder || `Select ${doctype}`\"\n      :options=\"linkOptions\"\n      @input=\"handleInputChange\"\n      @focus=\"() => loadOptions('')\"\n      :open-on-focus=\"true\"\n      v-bind=\"attrsWithoutClassStyle\"\n      :variant=\"props.variant\"\n    >\n      <template #create-new=\"{ searchTerm }\">\n        <LucidePlus class=\"size-4 mr-2\" />\n        <span class=\"font-medium\"> Create new {{ doctype }}</span>\n      </template>\n    </Combobox>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { watch, useAttrs, computed } from 'vue'\nimport { Combobox, type ComboboxOption } from '../../src/components/Combobox'\nimport FormLabel from '../../src/components/FormLabel.vue'\nimport debounce from '../../src/utils/debounce'\n// @ts-ignore - Vue SFC without explicit types\nimport { createResource } from '../../src/resources'\nimport { frappeRequest } from '../../src/utils/frappeRequest'\nimport type { LinkProps, SelectOption } from './types'\nimport LucidePlus from '~icons/lucide/plus'\n\nconst props = withDefaults(defineProps<LinkProps>(), {\n  label: '',\n  filters: () => ({}),\n  variant: 'subtle',\n})\nconst model = defineModel<string | null>({ default: '' })\nconst emit = defineEmits<{\n  (e: 'create', searchTerm: string): void\n}>()\ndefineOptions({ inheritAttrs: false })\n\nconst attrs = useAttrs() as Record<string, any>\nconst attrsWithoutClassStyle = computed(() => {\n  return Object.fromEntries(\n    Object.entries(attrs).filter(([key]) => key !== 'class' && key !== 'style'),\n  )\n})\n\nconst options = createResource({\n  url: 'frappe.desk.search.search_link',\n  params: {\n    doctype: props.doctype,\n    txt: '',\n    filters: props.filters,\n  },\n  method: 'POST',\n  resourceFetcher: frappeRequest,\n  transform: (data: SelectOption[]) => {\n    return data.map((doc) => ({\n      label: doc.label || doc.value,\n      value: doc.value,\n    }))\n  },\n})\n\nconst createNewOption = {\n  type: 'custom' as const,\n  key: 'create_new',\n  label: 'Create New',\n  slotName: 'create-new',\n  condition: () => true,\n  onClick: ({ searchTerm }) => emit('create', searchTerm),\n} as ComboboxOption\n\nconst linkOptions = computed(() => {\n  const _options = options.data || []\n  if (props.allowCreate) {\n    return [..._options, createNewOption]\n  }\n  return _options\n})\n\nconst loadOptions = (txt: string = '') => {\n  options.update({\n    params: {\n      txt,\n      doctype: props.doctype,\n      filters: props.filters,\n    },\n  })\n  options.reload()\n}\n\nconst handleInputChange = debounce((inputString: string) => {\n  loadOptions(inputString || '')\n}, 300)\n\nwatch([() => props.doctype, () => props.filters], () => loadOptions(''), {\n  immediate: true,\n  deep: true,\n})\n</script>\n","import { toast } from \"../../src/components/Toast/index\"\nimport type { DataImportStatus } from './types'\nimport call from '../../src/utils/call';\n\nexport const getBadgeColor = (status: DataImportStatus) => {\n    const colorMap = {\n        \"Pending\": \"orange\",\n        \"Success\": \"green\",\n        \"Partial Success\": \"orange\",\n        \"Error\": \"red\",\n        \"Timed Out\": \"orange\"\n    } as const;\n    return colorMap[status as DataImportStatus] || \"gray\"\n}\n\nexport const fieldsToIgnore = [\n    \"Section Break\",\n    \"Column Break\",\n    \"Tab Break\",\n    \"HTML\",\n    \"Table\",\n    \"Table MultiSelect\",\n    \"Button\",\n    \"Image\",\n    \"Fold\",\n    \"Heading\"\n]\n\nexport const getChildTableName = (doctype: string, parentDocType: string, docs: any[]) => {\n    let childTableName = ''\n    let doctypeFields = docs.filter((doc: any) => {\n        return doc.name == parentDocType\n    })[0].fields\n\n   doctypeFields.forEach((field: any) => {\n        if (field.options == doctype) {\n            childTableName = field.fieldname\n        }\n   })\n    return childTableName\n}\n\nexport const getPreviewData = (importName: string, file: string | undefined, sheet: string | undefined) => {\n    return call(\"frappe.core.doctype.data_import.data_import.get_preview_from_template\", {\n        data_import: importName,\n        import_file: file,\n        google_sheets_url: sheet\n    }).catch((error: any) => {\n        toast.error(error.messages?.[0] || error)\n        console.error(\"Error fetching preview data:\", error)\n    })\n}","<template>\n    <div class=\"flex min-h-0 flex-col text-base py-5 w-[90%] lg:w-[700px] mx-auto\">\n\t\t<div class=\"flex items-center justify-between\">\n\t\t\t<div>\n\t\t\t\t<div class=\"text-xl font-semibold mb-1 text-ink-gray-9\">\n\t\t\t\t\tData Import\n\t\t\t\t</div>\n\t\t\t\t<div class=\"text-ink-gray-6 leading-5\">\n\t\t\t\t\tImport data into your system using CSV files.\n\t\t\t\t</div>\n\t\t\t</div>\n            <Button variant=\"solid\" @click=\"showModal = true\">\n                <template #prefix>\n                    <FeatherIcon name=\"plus\" class=\"size-4 stroke-1.5\" />\n                </template>\n                Import\n            </Button>\n\t\t</div>\n\n        <div class=\"flex items-center space-x-2 my-5\">\n            <FormControl\n                v-model=\"search\"\n                placeholder=\"Search imported files\"\n                type=\"text\"\n                class=\"flex-1\"\n            />\n            <FormControl\n                v-model=\"importStatus\"\n                type=\"select\"\n                :options=\"importOptions\"\n            />\n        </div>\n\n        <div v-if=\"dataImports.data?.length\" class=\"overflow-y-scroll\">\n            <div class=\"divide-y\">\n                <div class=\"grid grid-cols-[75%,20%] lg:grid-cols-[85%,20%] items-center text-sm text-ink-gray-5 py-1.5 mx-2 my-0.5 px-1\">\n                    <div>\n                        Name\n                    </div>\n                    <div class=\"pl-1\">\n                        Status\n                    </div>\n                </div>\n                <div \n                    v-for=\"dataImport in dataImports.data\" \n                    @click=\"() => redirectToImport(dataImport.name!)\"\n                    class=\"grid grid-cols-[75%,20%] lg:grid-cols-[85%,20%] items-center cursor-pointer py-2.5 px-1 mx-2\"\n                >\n                    <div class=\"space-y-1\">\n                        <div class=\"text-ink-gray-7\">\n                            {{ dataImport.reference_doctype }}\n                        </div>\n                        <div class=\"text-ink-gray-5\">\n                            {{ dayjs(dataImport.creation).fromNow() }}\n                        </div>\n                    </div>\n                    <Badge :label=\"dataImport.status\" :theme=\"getBadgeColor(dataImport.status) as BadgeProps['theme']\" class=\"w-fit\" />\n                </div>\n            </div>\n            <div class=\"my-5 flex justify-center\">\n                <Button v-if=\"props.dataImports.hasNextPage\" @click=\"props.dataImports.next()\">\n                    <template #prefix>\n                        <FeatherIcon name=\"refresh-cw\" class=\"size-4 stroke-1.5\" />\n                    </template>\n                    Load More\n                </Button>\n            </div>\n        </div>\n        <div v-else class=\"text-sm italic text-ink-gray-5 mt-5\">\n            No data imports found.\n        </div>\n        <Dialog\n            v-model=\"showModal\"\n            :options=\"{\n                title: 'New Data Import',\n                actions: [{\n                    label: 'Continue',\n                    variant: 'solid',\n                    onClick({ close }) {\n                        createDataImport(close)\n                    }\n                }]\n            }\"\n        >\n            <template #body-content>\n                <div>\n                    <Link \n                        v-model=\"doctypeForImport\"\n                        doctype=\"DocType\"\n                        :filters=\"{\n                            'allow_import': 1\n                        }\"\n                        label=\"Choose a Document Type to import\"\n                    />\n                </div>\n            </template>\n        </Dialog>\n\t</div>\n</template>\n<script setup lang=\"ts\">\nimport { computed, ref, watch } from 'vue'\nimport { useRouter } from 'vue-router'\nimport type { DataImports, DataImport } from './types'\nimport { dayjs } from \"../../src/utils/dayjs\"\nimport { getBadgeColor } from \"./dataImport\"\nimport Badge from '../../src/components/Badge/Badge.vue'\nimport type { BadgeProps } from '../../src/components/Badge/types'\nimport { toast } from \"../../src/components/Toast/index\"\nimport Button from '../../src/components/Button/Button.vue'\nimport Dialog from '../../src/components/Dialog/Dialog.vue'\nimport FeatherIcon from '../../src/components/FeatherIcon.vue'\nimport FormControl from '../../src/components/FormControl/FormControl.vue'\nimport Link from \"../Link/Link.vue\"\n\nconst search = ref('')\nconst importStatus = ref('All')\nconst showModal = ref(false)\nconst doctypeForImport = ref<string | null>(null)\nconst emit = defineEmits(['updateStep'])\nconst router = useRouter()\n\nconst props = defineProps<{\n    dataImports: DataImports\n}>()\n\nconst importOptions = computed(() => {\n    const options = [\"All\", \"Pending\", \"Success\", \"Partial Success\", \"Error\", \"Timed Out\"]\n    return options.map(option => ({ label: option, value: option }))\n})\n\nwatch([search, importStatus], ([newSearch, newStatus]) => {\n    props.dataImports.update({\n        filters: [\n            newSearch ? [['name', 'like', `%${newSearch}%`]] : [],\n            newStatus !== 'All' ? [['status', '=', newStatus]] : [],\n        ].flat(),\n    })\n    props.dataImports.reload()\n})\n\nconst createDataImport = (close: () => void) => {\n    props.dataImports.insert.submit({\n        reference_doctype: doctypeForImport.value!,\n        import_type: 'Insert New Records',\n        mute_emails: true,\n        status: 'Pending',\n    }, {\n        onSuccess(data: DataImport) {\n            router.replace({\n                name: 'DataImport',\n                params: {\n                    importName: data.name\n                },\n            })\n            close()\n        },\n        onError(error: any) {\n            console.error(error)\n            toast.error(error.messages?.[0] || error)\n        }\n    })\n}\n\nconst redirectToImport = (importName: string) => {\n    router.replace({\n        name: 'DataImport',\n        params: {\n            importName\n        },\n    })\n}\n</script>","<template>\n    <div class=\"flex items-center space-x-3 lg:space-x-10 text-xs lg:text-base\">\n        <div class=\"flex items-center space-x-1 lg:space-x-2 text-ink-gray-5 cursor-pointer\" \n        :class=\"{\n            'text-ink-gray-9 font-semibold': onUploadStep\n        }\"\n        @click=\"emit('updateStep', 'upload', { ...data })\"\n        >\n            <FeatherIcon v-if=\"uploadStepCompleted\" name=\"check\" class=\"size-5 text-sm border rounded-[5px] p-0.5\" :class=\"{\n                'text-ink-white bg-surface-gray-7': onUploadStep,\n            }\"/>\n            <div v-else class=\"text-sm border rounded-[5px] px-1.5 py-0.5\" :class=\"{\n                'text-ink-white bg-surface-gray-7': onUploadStep,\n            }\">\n                <span>\n                    1\n                </span>\n            </div>\n            <div>\n                Upload File\n            </div>\n        </div>\n        <div class=\"flex items-center space-x-1 lg:space-x-2 text-ink-gray-5\" \n        :class=\"{\n            'text-ink-gray-9 font-semibold': onMapStep,\n            'cursor-pointer': uploadStepCompleted\n        }\"\n        @click=\"moveToMapStep()\"\n        >\n            <FeatherIcon v-if=\"mapStepCompleted\" name=\"check\" class=\"size-5 text-sm border rounded-[5px] p-0.5\" :class=\"{\n                'text-ink-white bg-surface-gray-7': onMapStep,\n            }\"/>\n            <div v-else class=\"text-sm border rounded-[5px] px-1.5 py-0.5\" :class=\"{\n                'text-ink-white bg-surface-gray-7': onMapStep,\n            }\">\n                <span>\n                    2\n                </span>\n            </div>\n            <div>\n                Map Data\n            </div>\n        </div>\n        <div class=\"flex items-center space-x-1 lg:space-x-2 text-ink-gray-5\" \n        :class=\"{\n            'text-ink-gray-9 font-semibold': onPreviewStep,\n            'cursor-pointer': uploadStepCompleted\n        }\"\n        @click=\"moveToPreviewStep()\"\n        >\n            <FeatherIcon v-if=\"previewStepCompleted\" name=\"check\" class=\"size-5 text-sm border rounded-[5px] p-0.5\" :class=\"{\n                'text-ink-white bg-surface-gray-7': onPreviewStep,\n            }\"/>\n            <div v-else class=\"text-sm border rounded-[5px] px-1.5 py-0.5\" :class=\"{\n                'text-ink-white bg-surface-gray-7': onPreviewStep,\n            }\">\n                <span>\n                    3\n                </span>\n            </div>\n            <div>\n                Review & Import\n            </div>\n        </div>\n    </div>\n</template>\n<script setup lang=\"ts\">\nimport type { DataImport } from './types'\nimport { computed } from 'vue'\nimport FeatherIcon from '../../src/components/FeatherIcon.vue'\n\nconst emit = defineEmits(['updateStep'])\n\nconst props = defineProps<{\n    data: DataImport | null\n    step: 'list' | 'upload' | 'map' | 'preview'\n}>()\n\nconst onUploadStep = computed(() => {\n    return props.step === 'upload'\n})\n\nconst uploadStepCompleted = computed(() => {\n    return props.data?.import_file || props.data?.google_sheets_url\n})\n\nconst onMapStep = computed(() => {\n    return props.step === 'map'\n})\n\nconst mapStepCompleted = computed(() => {\n    return props.data && props.data?.template_options && JSON.parse(props.data.template_options).column_to_field_map\n})\n\nconst onPreviewStep = computed(() => {\n    return props.step === 'preview'\n})\n\nconst previewStepCompleted = computed(() => {\n    return props.data?.status === 'Success'\n})\n\nconst moveToMapStep = () => {\n    if (uploadStepCompleted.value) {\n        emit('updateStep', 'map', { ...props.data })\n    }\n}\n\nconst moveToPreviewStep = () => {\n    if (uploadStepCompleted.value) {\n        emit('updateStep', 'preview', { ...props.data })\n    }\n}\n</script>","<template>\n    <div class=\"w-[85%] lg:w-[700px] mx-auto py-12 space-y-8 text-base\">\n       <div class=\"flex justify-between\">\n            <div class=\"space-y-2\">\n                <div class=\"text-lg font-semibold text-ink-gray-9\">\n                    <span>\n                        Map Data\n                    </span>\n                    <Badge v-if=\"data?.status\" :theme=\"getBadgeColor(data?.status)\">\n                        {{ data?.status }}\n                    </Badge>\n                </div>\n                <div class=\"leading-5 text-ink-gray-7\">\n                    Change the mapping of columns from your file to fields in the system\n                </div>\n            </div>\n            \n            <div class=\"flex flex-col lg:flex-row space-y-2 lg:space-x-2 lg:space-y-0\">\n                <Button v-if=\"mappingUpdated\" label=\"Reset Mapping\" @click=\"resetMapping\" />\n                <Button label=\"Continue\" variant=\"solid\" @click=\"$emit('updateStep', 'preview')\" />\n            </div>\n       </div>\n\n       <div v-if=\"Object.keys(columnMappings).length\" class=\"border rounded-md space-y-8\">\n            <div class=\"grid grid-cols-2 text-ink-gray-5 border-b py-2 px-4\">\n                <div>\n                    Fields in File\n                </div>\n                <div>\n                    Fields in System\n                </div>\n            </div>\n            <div class=\"grid grid-cols-2 py-2 px-4 gap-y-8\">\n                <template v-for=\"i in columnsFromFile.length\" :key=\"i\">\n                    <div class=\"text-ink-gray-7\">{{ columnsFromFile[i - 1] }}</div>\n                    <Autocomplete\n                        :model-value=\"columnMappings[columnsFromFile[i - 1]]\"\n                        :options=\"columnsFromSystem\"\n                        placeholder=\"Select field\" \n                        @update:model-value=\"(val: any) => updateColumnMappings(i, val)\"\n                    />\n                </template>\n            </div>\n        </div>\n    </div>\n</template>\n<script setup lang=\"ts\">\nimport type { DataImport, DataImports } from './types';\nimport { fieldsToIgnore, getBadgeColor, getPreviewData } from './dataImport'\nimport { computed, nextTick, onMounted, ref } from 'vue';\nimport { toast } from \"../../src/components/Toast/index\"\nimport Autocomplete from '../../src/components/Autocomplete/Autocomplete.vue';\nimport Badge from '../../src/components/Badge/Badge.vue';\nimport Button from '../../src/components/Button/Button.vue';\n\nconst previewData = ref<any>(null);\nconst emit = defineEmits(['updateStep'])\nconst columnMappings = ref<Record<string, string>>({});\nconst mappingUpdated = ref(false);\n\nconst props = defineProps<{\n    dataImports: DataImports\n    data: DataImport\n    fields: any\n}>()\n\nonMounted(async () => {\n    previewData.value = await getPreviewData(props.data.name!, props.data.import_file, props.data.google_sheets_url);\n    initializeColumnMappings();\n});\n\nconst initializeColumnMappings = () => {\n    const mappings: Record<string, string> = {};\n    let columnToFieldMap = []\n    if (props.data?.template_options)\n        columnToFieldMap = JSON.parse(props.data?.template_options)?.[\"column_to_field_map\"];\n\n        if (Object.keys(columnToFieldMap).length > 0)\n            mappingUpdated.value = true;\n\n        columnsFromFile.value.forEach((col: string, index: number) => {\n        if (columnToFieldMap && columnToFieldMap[index])\n            mappings[col] = getMappedColumnName(columnToFieldMap[index]);\n        else\n            mappings[col] = col;\n    });\n\n    columnMappings.value = mappings;\n}\n\nconst getMappedColumnName = (fieldname: string) => {\n    const field = columnsFromSystem.value.find((f: any) => f.value == fieldname);\n    if (field)\n        return field.label;\n    return fieldname;\n}\n\nconst updateColumnMappings = (index: number, value: any) => {\n    if (!value) return;\n    mappingUpdated.value = true;\n    let templateOptions = props.data?.template_options ? JSON.parse(props.data?.template_options) : {};\n    let columnToFieldMap = templateOptions[\"column_to_field_map\"] || {};\n    columnToFieldMap[index - 1] = value.value;\n\n    props.dataImports.setValue.submit({\n        ...props.data,\n        template_options: JSON.stringify({\n            ...templateOptions,\n            column_to_field_map: columnToFieldMap\n        })\n    }, {\n        onSuccess: (data: DataImport) => {\n            emit('updateStep', 'map', { ...data })\n            nextTick(() => {\n                initializeColumnMappings()\n            })\n        },\n        onError: (error: any) => {\n            toast.error(error.messages?.[0] || error)\n            console.error(\"Error updating column mappings:\", error);\n        }\n    })\n}\n\nconst columnsFromFile = computed(() => {\n    const columns: string[] = [];\n    previewData.value?.columns.forEach((col: any) => {\n        if (col.header_title != \"Sr. No\")\n            columns.push(col.header_title);\n    })\n    return columns;\n})\n\nconst columnsFromSystem = computed(() => {\n  const parent = props.data!.reference_doctype\n  const docs = props.fields.data?.docs || []\n\n  return docs\n    .map((doc: any) => {\n      const isParent = doc.name === parent\n\n      const columns = doc.fields\n        .filter((f: any) => !fieldsToIgnore.includes(f.fieldtype))\n        .map((f: any) => ({\n          value: f.fieldname,\n          label: isParent\n            ? f.label\n            : `${f.label} (${getChildTableName(parent, doc.name)})`,\n        }))\n\n      return [\n        { value: \"name\", label: \"ID\" },\n        ...columns,\n      ]\n    })\n    .flat()\n})\n\nconst resetMapping = () => {\n    let templateOptions = props.data?.template_options ? JSON.parse(props.data?.template_options) : {};\n    props.dataImports.setValue.submit({\n        ...props.data,\n        template_options: JSON.stringify({\n            ...templateOptions,\n            column_to_field_map: {}\n        })\n    }, {\n        onSuccess: (data: DataImport) => {\n            emit('updateStep', 'map', { ...data })\n            nextTick(() => {\n                initializeColumnMappings()\n            })\n        },\n        onError: (error: any) => {\n            toast.error(error.messages?.[0] || error)\n            console.error(\"Error resetting column mappings:\", error);\n        }\n    })\n}\n\nconst getChildTableName = (parent: string, child: string) => {\n    let parentFields = props.fields.data?.docs.find((doc: any) => doc.name == parent)?.fields || [];\n    \n    let childField = parentFields.filter((field: any) => field.options == child)[0]\n    return childField?.label || child;\n}\n</script>","<template>\n    <div class=\"text-base h-full flex flex-col w-[90%] lg:w-[700px] mx-auto py-12 space-y-10\">\n        <div class=\"flex flex-col space-y-1\">\n            <div class=\"flex items-center justify-between text-ink-gray-7\">\n                <div class=\"flex items-center space-x-2 text-lg font-semibold text-ink-gray-9\">\n                    <span>\n                        Review and Import\n                    </span>\n\n                    <Badge :theme=\"getBadgeColor(data.status)\">\n                        {{ data.status }}\n                    </Badge>\n                </div>\n                <Button \n                    v-if=\"data.status != 'Success'\" \n                    :label=\"data.status != 'Pending' ? 'Retry' : 'Import'\" \n                    variant=\"solid\" @click=\"startImport\" />\n                <Button v-else-if=\"listRoute\" label=\"Done\" @click=\"redirectToList()\" />\n            </div>\n            <div class=\"leading-5 text-ink-gray-7\">\n                Verify the data before starting the import process\n            </div>\n        </div>\n\n        <div v-if=\"mapping.length\" class=\"space-y-2\">\n            <div class=\"text-ink-gray-5 text-sm\">\n                Column Mapping\n            </div>\n            <div class=\"border rounded-md bg-surface-gray-2 p-4 space-y-4 text-sm text-ink-gray-7\">\n                <div v-for=\"map in mapping\" class=\"grid grid-cols-[40%,10%,40%] lg:grid-cols-3 space-x-3 items-center\">\n                    <div class=\"\">\n                        {{ map[0] }}\n                    </div>\n                    <div class=\"flex justify-end\">\n                        <FeatherIcon name=\"arrow-right\" class=\"inline size-4 text-ink-gray-5\" />\n                    </div>\n                    <div>\n                        {{ map[1] }}\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div v-if=\"warnings.length\" class=\"space-y-2\">\n            <div class=\"text-ink-gray-5 text-sm\">\n                Warnings\n            </div>\n            <div class=\"rounded-md bg-surface-amber-2 p-2 space-y-2 text-xs\">\n                <div v-for=\"warning in warnings\" class=\"flex items-center space-x-2\">\n                    <FeatherIcon name=\"alert-circle\" class=\"size-3 text-ink-amber-3\" />\n                    <div v-html=\"warning.message\" class=\"text-ink-amber-3\"></div>\n                </div>\n            </div>\n        </div>\n\n        <div v-if=\"preview?.data?.length\" class=\"border rounded-md overflow-x-auto\">\n            <table class=\"divide-y\">\n                <thead class=\"rounded-t-md\">\n                    <tr>\n                        <th\n                            v-for=\"column in previewColumns\"\n                            :key=\"column.key\"\n                            :style=\"{ minWidth: column.width, textAlign: column.align }\"\n                            class=\"p-2 text-left text-sm text-ink-gray-5\"\n                            :class=\"{\n                                'border-r': column.key != previewColumns[previewColumns.length -1].key,\n                                'w-full': column.key == previewColumns[previewColumns.length -1].key\n                            }\"\n                        >\n                            {{ column.label }}\n                        </th>\n                    </tr>\n                </thead>\n                <tbody class=\"bg-surface-white divide-y divide-surface-gray-2\">\n                    <tr v-for=\"(row, rowIndex) in previewData\" :key=\"rowIndex\">\n                        <td\n                            v-for=\"column in previewColumns\"\n                            :key=\"column.key\"\n                            :style=\"{ minWidth: column.width, textAlign: column.align }\"\n                            class=\"px-3 py-2 text-sm text-ink-gray-7 align-top\"\n                            :class=\"{\n                                'border-r': column.key != previewColumns[previewColumns.length -1].key\n                            }\"\n                        >\n                            <div class=\"leading-5 text-sm\">\n                                {{ row[column.key] }}\n                            </div>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n\n        <div v-if=\"data.status != 'Pending' && importLogs.length\" class=\"space-y-4\">\n\n            <div class=\"font-semibold text-ink-gray-9\">\n                Import Logs\n            </div>\n\n            <div class=\"rounded-md p-2\" :class=\"importBannerClass\">\n                {{ importSuccessCount }} {{ importSuccessCount == 1 ? 'row' : 'rows' }} imported successfully, {{ importErrorCount }} {{ importErrorCount == 1 ? 'row' : 'rows' }} failed.\n            </div>\n\n            <TabButtons :buttons=\"tabButtons\" v-model=\"activeTab\" class=\"w-fit\" />\n\n            <div v-if=\"filteredLogs.length\" class=\"border rounded-md overflow-x-auto\">\n                <table class=\"table-fixed w-full divide-y\">\n                    <thead class=\"rounded-t-md\">\n                        <tr>\n                            <th\n                                class=\"p-2 text-left text-sm text-ink-gray-5 w-20 border-r text-center\"\n                            >\n                                Row no.\n                            </th>\n                            <th class=\"p-2 text-left text-sm text-ink-gray-5 w-[80%]\">\n                                Message\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody class=\"bg-surface-white divide-y divide-surface-gray-2\">\n                        <tr v-for=\"(row, rowIndex) in filteredLogs\" :key=\"rowIndex\" class=\"group\">\n                            <td class=\"px-3 py-2 text-sm text-ink-gray-7 border-r\">\n                                <div class=\"flex items-center justify-center space-x-2\">\n                                    <div v-if=\"row.success\" class=\"size-1.5 bg-surface-green-3 rounded\"></div>\n                                    <div v-else class=\"size-1.5 bg-surface-red-5 rounded\"></div>\n                                    <div>\n                                        {{ JSON.parse(row[\"row_indexes\"])[0] - 1 }}\n                                    </div>\n                                </div>\n                            </td>\n                            \n                            <td class=\"px-3 py-2 text-sm text-ink-gray-7 w-full\">\n                                <span v-if=\"rowMessage(row)\" v-html=\"rowMessage(row)\">\n                                </span>\n                                <span v-else-if=\"!rowMessage(row) && !row.success\">\n                                    Failed to import\n                                </span>\n                                <span v-else-if=\"row.success\">\n                                    Successfully imported \n                                    <span @click=\"redirectToPage(row.docname)\" :class=\"{\n                                        'cursor-pointer underline': pageRoute\n                                    }\"> {{ row.docname }} </span>\n                                </span>\n                            </td>\n                            <td class=\"px-3 py-2 text-ink-gray-5 float-right invisible group-hover:visible\">\n                                <Popover v-if=\"row.exception\" trigger=\"hover\" placement=\"left-start\">\n                                    <template #target>\n                                        <FeatherIcon name=\"info\" class=\"size-4\" />\n                                    </template>\n                                    <template #body-main>\n                                        <div class=\"w-[500px] p-2 text-xs leading-5 font-mono\">\n                                            {{ row.exception }}\n                                        </div>\n                                    </template>\n                                </Popover>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n            <div v-else class=\"text-ink-gray-5 text-sm\">\n                No logs to display.\n            </div>\n        </div>\n    </div>\n</template>\n<script setup lang=\"ts\">\nimport { getPreviewData, getBadgeColor } from './dataImport'\nimport { computed, nextTick, onMounted, ref, watch } from 'vue';\nimport type { DataImport, DataImports } from './types';\nimport Badge from '../../src/components/Badge/Badge.vue';\nimport Button from '../../src/components/Button/Button.vue';\nimport call from '../../src/utils/call';\nimport FeatherIcon from '../../src/components/FeatherIcon.vue'\nimport initSocket from \"../../src/utils/socketio\";\nimport Popover from \"../../src/components/Popover/Popover.vue\"\nimport TabButtons from '../../src/components/TabButtons/TabButtons.vue';\n\nconst preview = ref<any>(null);\nconst emit = defineEmits(['updateStep'])\nconst importLogs = ref<any[]>([]);\nconst filteredLogs = ref<any[]>([]);\nconst activeTab = ref('all');\n\nconst props = defineProps<{\n    dataImports: DataImports\n    data: DataImport\n    fields: any\n    doctypeMap: Record<string, { title: string; listRoute?: string; pageRoute?: string }>\n}>()\n\nonMounted(async () => {\n    let socket = initSocket();\n    socket.on(\"data_import_refresh\", (data: { data_import: string }) => {\n        reloadPreviewData(data.data_import);\n    })\n\n    if (!props.data?.name) return;\n    preview.value = await getPreviewData(\n        props.data.name, props.data.import_file, props.data.google_sheets_url\n    );\n    if (props.data.status != \"Pending\") {\n        getImportLogs();\n    }\n});\n\nconst reloadPreviewData = (dataImport: string) => {\n    if (dataImport != props.data.name) return;\n    nextTick(() => {\n        props.dataImports.reload()\n        nextTick(async () => {\n            let updatedData = props.dataImports.data?.find(d => d.name === props.data.name\n            )\n            emit('updateStep', 'preview', { ...updatedData })\n            getImportLogs()\n        })\n    })\n}\n\nconst previewColumns = computed(() => {\n    const columns: any[] = [];\n    preview.value?.columns.forEach((col: any, index: number) => {\n        let align = 'left';\n        let width = \"300px\"\n        if (index == 0) {\n            col.header_title = \"No\"\n            align = 'center';\n            width = \"60px\"\n        } else if (col.header_title == \"ID\") {\n            width = \"150px\"\n        }\n        columns.push({\n            key: col.header_title,\n            label: col.header_title,\n            width: width,\n            align: align,\n        });\n    });\n    return columns;\n})\n\nconst previewData = computed(() => {\n    const data: Record<string, any>[] = [];\n    preview.value?.data.forEach((row: any) => {\n        const dataMap: Record<string, any> = {};\n        Object.keys(row).forEach((key: any, index: number) => {\n            let columnLabel = getColumnLabel(index)\n            let mappedFieldIndex = getMappedColumnName(index);\n            if (columnLabel == \"No\") {\n                dataMap[columnLabel] = row[key] - 1;\n            } else if (mappedFieldIndex) {\n                dataMap[columnLabel] = row[mappedFieldIndex];\n            } else {\n                dataMap[columnLabel] = row[key];\n            }\n        })\n        data.push(dataMap);\n    })\n    return data;\n})\n\nconst getColumnLabel = (index: number) => {\n    return preview.value?.columns[index]?.header_title || `Column ${index + 1}`;\n}\n\nconst getMappedColumnName = (index: number) => {\n    let mappedColumn = preview.value?.columns[index]?.map_to_field\n    if (!mappedColumn) return null\n    let mappedColumnLabel = preview.value?.columns[index]?.df?.label\n    let mappedColumnIndex = preview.value?.columns.filter((col: any) => col.header_title == mappedColumnLabel)[0]?.column_number\n    return mappedColumnIndex;\n}\n\nconst startImport = () => {\n    call(\"frappe.core.doctype.data_import.data_import.form_start_import\", {\n        data_import: props.data.name\n    })\n}\n\nconst getImportLogs = () => {\n    call(\"frappe.core.doctype.data_import.data_import.get_import_logs\", {\n        data_import: props.data.name\n    }).then((data: any) =>  {\n        importLogs.value = data;\n        filteredLogs.value = data;\n    })\n}\n\nconst updateImportLogs = () => {\n    if (activeTab.value == 'all') {\n        filteredLogs.value = importLogs.value;\n    } else if (activeTab.value == 'successful') {\n        filteredLogs.value = importLogs.value.filter(log => log.success);\n    } else if (activeTab.value == 'failed') {\n        filteredLogs.value = importLogs.value.filter(log => !log.success);\n    }\n}\n\nwatch(activeTab, () => {\n    updateImportLogs();\n})\n\nconst importSuccessCount = computed(() => {\n    if (!importLogs.value.length) return 0;\n    return importLogs.value.filter(log => log.success).length\n})\n\nconst importErrorCount = computed(() => {\n    if (!importLogs.value.length) return 0;\n    return importLogs.value.filter(log => !log.success).length\n})\n\nconst importBannerClass = computed(() => {\n    if (importErrorCount.value == 0) {\n        return 'bg-surface-green-2 text-ink-green-3'\n    } else if (importSuccessCount.value == 0) {\n        return 'bg-surface-red-2 text-ink-red-3'\n    } else {\n        return 'bg-surface-amber-2 text-ink-amber-3'\n    }\n})\n\nconst mapping = computed(() => {\n    let warningMap: string[][] = [];\n    if (!preview.value?.warnings?.length) return [];\n    preview.value.warnings.forEach((warning: any) => {\n        if (warning.type == \"info\") {\n            const regex = /<strong>(.*?)<\\/strong>/g;\n            let match;\n            const fields = [];\n            while ((match = regex.exec(warning.message)) !== null) {\n                fields.push(match[1]);\n            }\n            warningMap.push(fields);\n        }\n    })\n    return warningMap;\n})\n\nconst warnings = computed(() => {\n    return preview.value?.warnings?.filter((warning: any) => warning.type != \"info\") || [];\n})\n\nconst listRoute = computed(() => {\n    return props.doctypeMap[props.data.reference_doctype]?.listRoute\n})\n\nconst redirectToList = () => {\n    if (!listRoute.value) return;\n    window.location.href = listRoute.value;\n}\n\nconst pageRoute = computed(() => {\n    return props.doctypeMap[props.data.reference_doctype]?.pageRoute\n})\n\nconst redirectToPage = (docname: string) => {\n    if (!pageRoute.value) return;\n    window.location.href = pageRoute.value.replace('docname', docname);\n}\n\nconst tabButtons = computed(() => {\n    return [\n        { label: 'All', value: 'all' },\n        { label: 'Successful', value: 'successful' },\n        { label: 'Failed', value: 'failed' },\n    ]\n})\n\nconst rowMessage = (row: any) => {\n    return JSON.parse(row.messages)?.[0]?.message\n}\n</script>","<template>\n    <Dialog v-model=\"show\" :options=\"{\n        title: 'Export Data',\n        size: '2xl',\n    }\">\n        <template #body-content>\n            <div class=\"text-base space-y-5\">\n                <div class=\"grid grid-cols-2 gap-5\">\n                    <FormControl\n                        label=\"File Type\"\n                        v-model=\"fileType\"\n                        :options=\"['Excel', 'CSV']\"\n                        type=\"select\"\n                    />\n                </div>\n                <div class=\"border-t\">\n                    <p class=\"mt-2 text-ink-gray-5\">\n                        Select the fields you want to include in the template.\n                    </p>\n                    <div class=\"space-x-2 mt-2 mb-5\">\n                        <Button label=\"Select All\" @click=\"selectAllFields\" />\n                        <Button label=\"Select Mandatory Fields\" @click=\"selectMandatoryFields\" />\n                        <Button label=\"Unselect All\" @click=\"unselectAllFields\" />\n                    </div>\n                    <div class=\"space-y-8\">\n                        <div v-for=\"doctype in Object.keys(fields.data)\" :key=\"doctype\" class=\"flex flex-col space-y-2\">\n                            <div class=\"text-ink-gray-5\">\n                                {{ doctype }}\n                            </div>\n                            <div class=\"grid grid-cols-2 gap-5\">\n                                <div v-for=\"field in fields.data[doctype]\" :key=\"field.fieldname\" class=\"flex items-center space-x-2\">\n                                    <Checkbox\n                                        :id=\"`checkbox-${doctype}-${field.fieldname}`\"\n                                        :checked=\"fieldSelection[doctype][field.fieldname]\"\n                                        @change=\"(e: Event) => fieldSelection[doctype][field.fieldname] = (e.target as HTMLInputElement).checked\"\n                                        />\n                                    <label\n                                        :for=\"`checkbox-${doctype}-${field.fieldname}`\"\n                                        :class=\"{\n                                            'text-ink-red-3': field.reqd\n                                        }\">\n                                        {{ field.label || field.fieldname }}\n                                    </label>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </template>\n        <template #actions=\"{ close }\">\n            <div class=\"flex justify-end space-x-2\">\n                <Button label=\"Export\" variant=\"solid\" @click=\"handleExport\" />\n                <Button label=\"Cancel\" @click=\"close\" />\n            </div>\n        </template>\n    </Dialog>\n</template>\n<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport type { DocField } from './types'\nimport { createResource } from '../../src/resources'\nimport { fieldsToIgnore, getChildTableName } from './dataImport'\nimport Button from \"../../src/components/Button/Button.vue\"\nimport Checkbox from \"../../src/components/Checkbox/Checkbox.vue\"\nimport Dialog from \"../../src/components/Dialog/Dialog.vue\"\nimport FormControl from \"../../src/components/FormControl/FormControl.vue\"\n\nconst show = defineModel<boolean>({ required: true, default: false })\nconst fileType = ref<'Excel' | 'CSV'>('CSV')\nconst exportType = ref<'All Records' | '5 Records' | 'Blank Template'>('Blank Template')\nconst fieldSelection = ref<Record<string, Record<string, boolean>>>({})\nconst doctypeMeta = ref<any>(null)\n\nconst props = defineProps<{\n    doctype: string\n}>()\n\nconst fields = createResource({\n    url: \"frappe.desk.form.load.getdoctype\",\n    params: {\n        doctype: props.doctype,\n        with_parent: 1,\n    },\n    auto: true,\n    transform(data: any) {\n        doctypeMeta.value = data.docs\n        return transformFields(data)\n    }\n})\n\nconst transformFields = (data: any) => {\n    let doctypeMap: Record<string, { fieldname: string; label: string; reqd: number }[]> = {}\n\n    prepareDoctypeMap(data.docs, doctypeMap)\n    addIDField(doctypeMap)\n    updateFieldSelection(doctypeMap)\n\n    return doctypeMap\n}\n\nconst prepareDoctypeMap = (docs: any[], doctypeMap: Record<string, { fieldname: string; label: string; reqd: number }[]>) => {\n    docs.forEach((doc: any) => {\n        doctypeMap[doc.name] = doc.fields.filter((field: DocField) => {\n            return !fieldsToIgnore.includes(field.fieldtype)\n        }).map((field: DocField) => {\n            return {\n                fieldname: field.fieldname,\n                label: field.label,\n                reqd: field.reqd,\n                disabled: doc.name == props.doctype && field.reqd ? true : false,\n            }\n        })\n    })\n}\n\nconst addIDField = (doctypeMap: Record<string, { fieldname: string; label: string; reqd: number }[]>) => {\n    Object.keys(doctypeMap).forEach((doctype: string) => {\n        doctypeMap[doctype].unshift({\n            fieldname: \"name\",\n            label: \"ID\",\n            reqd: 1,\n        } as { fieldname: string; label: string; reqd: number })\n    })\n}\n\nconst updateFieldSelection = (doctypeMap: Record<string, { fieldname: string; label: string; reqd: number }[]>) => {\n    Object.keys(doctypeMap).forEach((doctype: string) => {\n        if (!fieldSelection.value[doctype]) {\n            fieldSelection.value[doctype] = {}\n            if (doctype == props.doctype) {\n                doctypeMap[doctype].forEach((field) => {\n                    if (field.reqd) {\n                        fieldSelection.value[doctype][field.fieldname] = true\n                    }\n                })\n            }\n        }\n    })\n}\n\nconst getExportURL = () => {\n    let doctype = props.doctype\n    let exportFields = getExportFields()\n    let exportRecords = getExportType()\n    let exportPageLength = exportType.value == \"5 Records\" ? 5 : ''\n    \n    return `/api/method/frappe.core.doctype.data_import.data_import.download_template\n        ?doctype=${encodeURIComponent(doctype)}\n        &export_fields=${encodeURIComponent(JSON.stringify(exportFields))}\n        &export_records=${encodeURIComponent(exportRecords)}\n        &file_type=${encodeURIComponent(fileType.value)}\n        &export_page_length=${exportPageLength}`\n        .replace(/\\s+/g, '')\n}\n\nconst handleExport = async () => {\n    let url = getExportURL()\n    const response = await fetch(url)\n    const blob = await response.blob();\n    const link = document.createElement('a');\n\n    link.href = URL.createObjectURL(blob);\n    link.download = props.doctype + (fileType.value === 'CSV' ? '.csv' : '.xlsx');\n    document.body.appendChild(link);\n\n    link.click();\n    document.body.removeChild(link);\n}\n\nconst getExportFields = () => {\n    let exportFields: Record<string, string[]> = {}\n    Object.keys(fieldSelection.value).forEach((doctype: string) => {\n        let doctypeName = doctype == props.doctype ? doctype : getChildTableName(doctype, props.doctype, doctypeMeta.value)\n        exportFields[doctypeName] = Object.keys(fieldSelection.value[doctype]).filter((fieldname: string) => fieldSelection.value[doctype][fieldname])\n    })\n    return exportFields\n}\n\nconst getExportType = () => {\n    if (exportType.value == \"Blank Template\")\n        return \"blank_template\"\n    if (exportType.value == \"5 Records\")\n        return \"5_records\"\n    return \"all\"\n}\n\nconst selectAllFields = () => {\n    Object.keys(fields.data).forEach((doctype: string) => {\n        fields.data[doctype].forEach((field: DocField) => {\n            if (!fieldSelection.value[doctype]) {\n                fieldSelection.value[doctype] = {};\n            }\n            fieldSelection.value[doctype][field.fieldname] = true;\n        })\n    })\n}\n\nconst selectMandatoryFields = () => {\n    Object.keys(fields.data).forEach((doctype: string) => {\n        fields.data[doctype].forEach((field: DocField) => {\n            fieldSelection.value[doctype][field.fieldname] = field.reqd ? true : false\n        })\n    })\n}\n\nconst unselectAllFields = () => {\n    Object.keys(fields.data).forEach((doctype: string) => {\n        fields.data[doctype].forEach((field: DocField) => {\n            fieldSelection.value[doctype][field.fieldname] = false\n        })\n    })\n}\n\n</script>","<template>\n    <div class=\"text-base h-full flex flex-col w-[85%] lg:w-[700px] mx-auto pt-12 space-y-8\">\n        <div class=\"flex flex-col space-y-1 text-ink-gray-7\">\n            <div class=\"flex items-center justify-between\">\n                <div class=\"flex items-center space-x-2 text-xl font-semibold text-ink-gray-9\">\n                    <span>\n                        Choose Import\n                    </span>\n                    <Badge v-if=\"data?.status\" :theme=\"getBadgeColor(data?.status)\">\n                        {{ data?.status }}\n                    </Badge>\n                </div>\n                <Button \n                    variant=\"solid\" \n                    @click=\"saveImport\"\n                    :disabled=\"disableContinueButton\"\n                >\n                    Continue\n                </Button>\n            </div>\n            <div class=\"leading-5\">\n                Import data into your system using CSV files or Google Sheets.\n            </div>\n        </div>\n\n        <div class=\"space-y-4\">\n            <div\n                v-if=\"showFileSelector && !importFile\"\n                @dragover.prevent\n                @drop.prevent=\"(e) =>  uploadFile(e)\" \n                class=\"h-[300px] flex items-center justify-center bg-surface-gray-1 border border-dashed border-outline-gray-3 rounded-md\">\n                <div v-if=\"showFileSelector && !uploading\" class=\"w-4/5 lg:w-2/5 text-center\">\n                    <FeatherIcon name=\"upload-cloud\" class=\"size-6 stroke-1.5 text-ink-gray-6 mx-auto mb-2.5\" />\n                    <input\n                        ref=\"fileInput\"\n                        type=\"file\"\n                        accept=\".csv\"\n                        class=\"hidden\"\n                        @change=\"(e) => uploadFile(e)\"\n                    />\n                    <div class=\"leading-5 text-ink-gray-9\">\n                        Drag and drop a CSV file, or upload from your \n                        <span @click=\"openFileSelector\" class=\"cursor-pointer font-semibold hover:underline\">Device</span> \n                        or \n                        <span @click=\"openSheetSelector\" class=\"cursor-pointer font-semibold hover:underline\"> \n                            Google Sheet \n                        </span>\n                    </div>\n                </div>\n                <div v-else-if=\"showFileSelector && uploading\" class=\"w-4/5 lg:w-2/5 bg-surface-white border rounded-md p-2\">\n                    <div class=\"space-y-2\">\n                        <div class=\"font-medium\">\n                            {{ uploadingdFile.name }}\n                        </div>\n                        <div class=\"text-ink-gray-6\">\n                            {{ convertToKB(uploaded) }} of {{ convertToKB(total) }}\n                        </div>\n                    </div>\n                    <div class=\"w-full bg-surface-gray-1 h-1 rounded-full mt-3\">\n                        <div \n                            class=\"bg-surface-gray-7 h-1 rounded-full transition-all duration-500 ease-in-out\"\n                            :style=\"`width: ${uploadProgress}%`\"\n                        ></div>\n                    </div>\n                </div>\n            </div>\n            <div v-else-if=\"importFile\" class=\"h-[300px] flex items-center justify-center bg-surface-gray-1 border border-dashed border-outline-gray-3 rounded-md\">\n                <div class=\"w-4/5 lg:w-2/5 bg-surface-white border rounded-md p-2 flex items-center justify-between items-center\">\n                    <div class=\"space-y-2\">\n                        <div class=\"font-medium leading-5 text-ink-gray-9\">\n                            {{ importFile.file_name || importFile.split(\"/\").pop() }}\n                        </div>\n                        <div v-if=\"importFile.file_size\" class=\"text-ink-gray-6\">\n                            {{ convertToKB(importFile.file_size) }}\n                        </div>\n                    </div>\n                    <FeatherIcon \n                        name=\"trash-2\" \n                        class=\"size-4 stroke-1.5 text-ink-red-3 cursor-pointer\"\n                        @click=\"deleteFile\"\n                    />\n                </div>\n            </div>\n\n            <div v-else-if=\"showSheetSelector\" class=\"flex flex-col h-[300px] p-4 border border-dashed border-outline-gray-3 rounded-md\">\n                <div class=\"flex items-center space-x-2 text-ink-gray-7\">\n                    <FeatherIcon name=\"chevron-left\" class=\"size-4 cursor-pointer\" @click=\"backToFileSelector\" />\n                    <div>\n                        Google Sheet\n                    </div>\n                </div>\n                <div class=\"flex-1 flex flex-col items-center justify-center w-[95%] lg:w-[400px] mx-auto space-y-3\">\n                    <input\n                        v-model=\"googleSheet\"\n                        type=\"text\"\n                        class=\"w-full border border-outline-gray-2 rounded-md px-2.5 text-base\"\n                        placeholder=\"Add Google Sheets Link\"\n                    />\n                    <div class=\"text-ink-gray-5\">\n                        Make sure the link is publically accessible to fetch the data.\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"flex justify-end\">\n                <Dropdown\n                    :options=\"[\n                        {\n                            label: 'Mandatory Fields',\n                            onClick() {\n                                exportTemplate('mandatory')\n                            },\n                        },\n                        {\n                            label: 'All Fields',\n                            onClick() {\n                                exportTemplate('all')\n                            },\n                        },\n                        {\n                            label: 'Custom Template',\n                            onClick() {\n                                showTemplateModal = true\n                            },\n                        }\n                    ]\"\n                >\n                    <template v-slot=\"{ open }\">\n                        <Button variant=\"ghost\">\n                            <template #prefix>\n                                <FeatherIcon name=\"download\" class=\"size-4 stroke-1.5\" />\n                            </template>\n                            Download CSV Template\n                            <template #suffix>\n                                <FeatherIcon name=\"chevron-down\" :class=\"[\n                                    'w-4 h-4 stroke-1.5 ml-1 transform transition-transform',\n                                    open ? 'rotate-180' : '',\n                                ]\" />\n                            </template>\n                        </Button>\n                    </template>\n                </Dropdown>\n            </div>\n        </div>\n\n        <TemplateModal\n            v-if=\"props.doctype || props.data?.reference_doctype\"\n            v-model=\"showTemplateModal\"\n            :doctype=\"props.doctype || props.data?.reference_doctype as string\"\n        />\n    </div>\n</template>\n<script setup lang=\"ts\">\nimport { computed, nextTick, ref, watch } from 'vue'\nimport { useRouter } from 'vue-router'\nimport type { DataImports, DataImport, DocField } from './types'\nimport { toast } from \"../../src/components/Toast/index\"\nimport { fieldsToIgnore, getChildTableName, getBadgeColor } from './dataImport'\nimport Badge from '../../src/components/Badge/Badge.vue'\nimport Button from '../../src/components/Button/Button.vue'\nimport Dropdown from '../../src/components/Dropdown/Dropdown.vue'\nimport FeatherIcon from '../../src/components/FeatherIcon.vue'\nimport FileUploadHandler from '../../src/utils/fileUploadHandler';\nimport TemplateModal from './TemplateModal.vue'\n\nconst emit = defineEmits(['updateStep'])\nconst importFile = ref<any | null>(null)\nconst googleSheet = ref<string>('')\nconst uploading = ref(false)\nconst uploadingdFile = ref<any | null>(null)\nconst uploaded = ref(0)\nconst total = ref(0)\nconst showTemplateModal = ref(false)\nconst fileInput = ref<HTMLInputElement | null>(null)\nconst showFileSelector = ref(true)\nconst showSheetSelector = ref(false)\nconst showLibrarySelector = ref(false)\nconst router = useRouter()\n\nconst props = defineProps<{\n    dataImports: DataImports\n    doctype?: string\n    fields: any\n    data: DataImport | null\n}>()\n\nconst uploadProgress = computed(() => {\n    if (total.value === 0) return 0\n    return Math.floor((uploaded.value / total.value) * 100)\n})\n\nconst extractFile = (e: Event): File | null => {\n    const inputFiles = (e.target as HTMLInputElement)?.files\n    const dt = (e as DragEvent).dataTransfer?.files\n\n    return inputFiles?.[0] || dt?.[0] || null\n}\n\nconst uploadFile = (e: Event) => {\n    const file = extractFile(e)\n    if (!file) return;\n    \n    if (file.type !== 'text/csv') {\n        toast.error('Please upload a valid CSV file.')\n        console.error('Please upload a valid CSV file.')\n        return;\n    }\n\n    uploadingdFile.value = file\n    const uploader = new FileUploadHandler()\n\n    uploader.on(\"start\", () => {\n        uploading.value = true\n    })\n\n    uploader.on(\"progress\", (data: { uploaded: number, total: number }) => {\n        uploaded.value = data.uploaded\n        total.value = data.total\n    })\n\n    uploader.on(\"error\", (error: any) => {\n        uploading.value = false\n        toast.error(error)\n        console.error('File upload error:', error)\n    })\n\n    uploader.on(\"finish\", () => {\n        uploading.value = false\n    })\n    uploader.upload(file, {}).then((data => {\n        importFile.value = data\n    })).catch(error => {\n        console.error('File upload error:', error)\n    })\n}\n\nconst saveImport = () => {\n    if (props.data?.name) {\n        updateImport()\n    } else {\n        createImport()\n    }\n}\n\nconst createImport = () => {\n    props.dataImports.insert.submit({\n        reference_doctype: props.doctype!,\n        import_type: \"Insert New Records\",\n        mute_emails: true,\n        status: 'Pending',\n        google_sheets_url: googleSheet.value.trim(),\n        import_file: importFile.value?.file_url,\n    }, {\n        onSuccess(data: DataImport) {\n            router.replace({\n                name: 'DataImport',\n                params: {\n                    importName: data.name\n                },\n                query: {\n                    step: 'map'\n                }\n            })\n        },\n        onError(error: any) {\n            toast.error(error.messages?.[0] || error)\n            console.error('Error creating data import:', error)\n        }\n    })\n}\n\nconst updateImport = () => {\n    if (!props.data) return;\n    props.dataImports.setValue.submit({\n        ...props.data,\n        google_sheets_url: googleSheet.value.trim(),\n        import_file: importFile.value ? importFile.value.file_url : '',\n    }, {\n        onSuccess(data: DataImport) {\n            nextTick(() => {\n                if (importFile.value || googleSheet.value.trim().length) {\n                    emit('updateStep', 'map', data)\n                } else {\n                    emit('updateStep', 'upload', data)\n                }\n            })\n        },\n        onError(error: any) {\n            toast.error(error.messages?.[0] || error, { duration: 1000 })\n            console.error('Error updating data import:', error)\n        }\n    })\n}\n\nconst exportTemplate = async (type: 'mandatory' | 'all') => {\n    let url = getExportURL(type)\n    const response = await fetch(url)\n    const blob = await response.blob();\n    const link = document.createElement('a');\n\n    link.href = URL.createObjectURL(blob);\n    link.download = props.doctype + '.csv'\n    document.body.appendChild(link);\n\n    link.click();\n    document.body.removeChild(link);\n}\n\nconst getExportURL = (type: 'mandatory' | 'all') => {\n    if (!props.doctype && !props.data?.reference_doctype) return ''\n    let exportFields = getExportFields(type)\n    \n    return `/api/method/frappe.core.doctype.data_import.data_import.download_template\n        ?doctype=${encodeURIComponent(props.doctype || props.data?.reference_doctype as string)}\n        &export_fields=${encodeURIComponent(JSON.stringify(exportFields))}\n        &export_records=blank_template\n        &file_type=CSV`\n        .replace(/\\s+/g, '')\n}\n\nconst getExportFields = (type: 'mandatory' | 'all') => {\n    /* {'Sales Invoice': ['name', 'customer'], 'Sales Invoice Item': ['item_code']} */\n    if (type == \"mandatory\") {\n        return getMandatoryFields()\n    }\n    return getAllFields()\n}\n\nconst getMandatoryFields = () => {\n    let parentDoctype = props.fields.data?.docs.find((doc: any) => doc.name == props.doctype)\n    let exportableFields = parentDoctype.fields.filter((field: DocField) => {\n        return !fieldsToIgnore.includes(field.fieldtype) && field.reqd\n    }).map((field: DocField) => field.fieldname)\n    exportableFields.unshift('name')\n    return {\n        [props.doctype || props.data?.reference_doctype as string]: exportableFields\n    }\n}\n\nconst getAllFields = () => {\n    let doctypeMap: Record<string, string[]> = {}\n    let docs = props.fields.data?.docs || []\n    docs.forEach((doc: any) => {\n        let exportableFields = doc.fields.filter((field: DocField) => {\n            return !fieldsToIgnore.includes(field.fieldtype)\n        }).map((field: DocField) => field.fieldname)\n        exportableFields.unshift('name')\n        let doctypeName = doc.name == props.doctype ? doc.name : getChildTableName(doc.name, props.doctype || props.data?.reference_doctype as string, docs)\n        doctypeMap[doctypeName] = exportableFields\n    })\n    return doctypeMap\n}\n\nconst openFileSelector = () => {\n    fileInput.value?.click()\n}\n\nconst openSheetSelector = () => {\n    showFileSelector.value = false\n    showLibrarySelector.value = false\n    showSheetSelector.value = true\n}\n\nconst backToFileSelector = () => {\n    showFileSelector.value = true\n    showLibrarySelector.value = false\n    showSheetSelector.value = false\n}\n\nconst disableContinueButton = computed(() => {\n    return !importFile.value && !googleSheet.value.trim().length\n})\n\nwatch(() => props.data, () => {\n    if (props.data) {\n        if (props.data.import_file) {\n            importFile.value = props.data.import_file\n        } else if (props.data.google_sheets_url) {\n            openSheetSelector()\n            googleSheet.value = props.data.google_sheets_url\n        }\n    }\n}, { immediate: true })\n\nwatch([importFile, googleSheet], () => {\n    if (!importFile.value || !googleSheet.value.trim().length) {\n        updateImport()\n    }\n})\n\nconst deleteFile = () => {\n    importFile.value = null\n}\n\nconst convertToKB = (bytes: number) => {\n    return (bytes / 1024).toFixed(2) + ' KB'\n}\n</script>","<template>\n  <header\n\t\tclass=\"sticky flex items-center justify-between space-x-28 top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n    >\n      <Breadcrumbs :items=\"breadcrumbs\" />\n      <ImportSteps class=\"flex-1 hidden lg:flex\" v-if=\"step != 'list'\" :data=\"data\" :step=\"step\" @updateStep=\"updateStep\" />\n  </header>\n  <div>\n      <ImportSteps class=\"flex-1 lg:hidden w-[90%] mx-auto mt-5\" v-if=\"step != 'list'\" :data=\"data\" :step=\"step\" @updateStep=\"updateStep\" />\n\n    <DataImportList\n      v-if=\"step === 'list'\"\n      :dataImports=\"dataImports\"\n      @updateStep=\"updateStep\"\n    />\n\n    <UploadStep\n      v-else-if=\"step === 'upload'\"\n      :dataImports=\"dataImports\"\n      :doctype=\"doctype || data?.reference_doctype\"\n      :fields=\"fields\"\n      :data=\"data\"\n      @updateStep=\"updateStep\"\n    />\n\n    <MappingStep\n      v-else-if=\"step === 'map'\"\n      :dataImports=\"dataImports\"\n      :data=\"data as DataImport\"\n      :fields=\"fields\"\n      @updateStep=\"updateStep\"\n    />\n\n    <PreviewStep\n      v-else-if=\"step === 'preview'\"\n      :dataImports=\"dataImports\"\n      :data=\"data as DataImport\"\n      :fields=\"fields\"\n      :doctypeMap=\"doctypeMap as Record<string, { title: string; listRoute?: string; pageRoute?: string }>\"\n      @updateStep=\"updateStep\"\n    />\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { computed, nextTick, ref, watch } from 'vue'\nimport type { DataImportProps, DataImport } from './types'\nimport { createListResource, createResource } from '../../src/resources'\nimport { useRoute } from 'vue-router'\nimport Breadcrumbs from '../../src/components/Breadcrumbs/Breadcrumbs.vue'\nimport DataImportList from './DataImportList.vue'\nimport ImportSteps from './ImportSteps.vue'\nimport MappingStep from './MappingStep.vue'\nimport PreviewStep from './PreviewStep.vue'\nimport UploadStep from './UploadStep.vue'\n\nconst route = useRoute()\nconst step = ref<'upload' | 'map' | 'list' | 'preview'>('list')\nconst data = ref<DataImport | null>(null)\n\nconst props = defineProps<Partial<DataImportProps>>()\n\n  const dataImports = createListResource({\n  doctype: 'Data Import',\n  fields: [\n    'name',\n    'reference_doctype',\n    'import_type',\n    'status',\n    'creation',\n    'mute_emails',\n    'import_file',\n    'google_sheets_url',\n    'template_options'\n  ],\n  auto: true,\n  orderBy: 'modified desc',\n})\n\nconst fields = createResource({\n  url: \"frappe.desk.form.load.getdoctype\",\n  makeParams: (values: { doctype: string }) => {\n    return {\n      doctype: values.doctype,\n      with_parent: 1,\n    }\n  },\n  auto: false,\n})\n\n\nconst updateData = () => {\n  data.value = dataImports.data?.find(\n    (di: DataImport) => di.name === props.importName,\n    ) || null\n}\n\nwatch(\n  () => [route.params, props, dataImports.data],\n  () => {\n    if (props.doctype) {\n      step.value = 'upload'\n      fields.reload({\n        doctype: route.params.doctype,\n      })\n    } else if (props.importName) {\n      updateData()\n      if (!data.value?.import_file && !data.value?.google_sheets_url) {\n        step.value = 'upload'\n      } else if (step.value == 'upload' && route.query.step == 'map') {\n        step.value = route.query.step\n      } else {\n        step.value = 'preview'\n      }\n      if (data.value?.reference_doctype) {\n        fields.reload({\n          doctype: data.value?.reference_doctype,\n        })\n      }\n    }\n  },\n  { immediate: true },\n)\n\nwatch(() => route.query, () => {\n  if (route.query.step == 'list') {\n    step.value = 'list'\n  }\n})\n\nconst updateStep = (newStep: 'list' | 'upload' | 'map' | 'preview', newData: DataImport) => {\n  step.value = newStep\n  if (newData) {\n    data.value = newData\n  }\n}\n\nconst doctypeTitle = computed(() => {\n  let doctype = props.doctype || data.value?.reference_doctype\n  return props.doctypeMap?.[doctype || '']?.title || doctype || ''\n})\n\nconst breadcrumbs = computed(() => {\n  let crumbs = [\n    {\n      label: 'Data Import',\n      route: { \n        name: 'DataImportList', \n        query: {\n          step: 'list'\n        } \n      },\n    },\n  ]\n\n  if (step.value !== 'list') {\n    crumbs.push({\n      label: `Importing ${doctypeTitle.value}`,\n    })\n  }\n\n  return crumbs\n})\n\n\n</script>\n","<template>\n  <DataImport\n    :doctype=\"route.params.doctype\"\n    :importName=\"route.params.importName\"\n    :doctypeMap=\"doctypeMap\"\n  />\n</template>\n\n<script setup>\nimport { usePageMeta } from 'frappe-ui'\nimport { DataImport } from 'frappe-ui/frappe'\nimport { useRoute } from 'vue-router'\n\nconst route = useRoute()\n\nconst doctypeMap = {\n  'CRM Lead': {\n    title: 'Leads',\n    listRoute: '/crm/leads',\n    pageRoute: `/crm/leads/docname`,\n  },\n  'CRM Deal': {\n    title: 'Deals',\n    listRoute: '/crm/deals',\n    pageRoute: `/crm/deals/docname`,\n  },\n  Contact: {\n    title: 'Contacts',\n    listRoute: '/crm/contacts',\n    pageRoute: `/crm/contacts/docname`,\n  },\n  'CRM Task': {\n    title: 'Tasks',\n    listRoute: '/crm/tasks',\n  },\n  'CRM Organization': {\n    title: 'Organizations',\n    listRoute: '/crm/organizations',\n    pageRoute: `/crm/organizations/docname`,\n  },\n  'CRM Call Log': {\n    title: 'Call Log',\n    listRoute: '/crm/call-logs',\n  },\n}\n\nusePageMeta(() => {\n  return {\n    title: __('Data Import'),\n  }\n})\n</script>\n"],"names":["props","__props","model","_useModel","emit","__emit","attrs","useAttrs","attrsWithoutClassStyle","computed","key","options","createResource","frappeRequest","data","doc","createNewOption","searchTerm","linkOptions","_options","loadOptions","txt","handleInputChange","debounce","inputString","watch","_createElementBlock","_normalizeClass","_unref","_normalizeStyle","label","_createBlock","FormLabel","required","_createVNode","_mergeProps","$event","placeholder","doctype","_withCtx","LucidePlus","_createElementVNode","_hoisted_1","getBadgeColor","status","fieldsToIgnore","getChildTableName","parentDocType","docs","childTableName","field","getPreviewData","importName","file","sheet","call","error","toast","_a","search","ref","importStatus","showModal","doctypeForImport","router","useRouter","importOptions","option","newSearch","newStatus","createDataImport","close","redirectToImport","_openBlock","_hoisted_2","Button","FeatherIcon","_hoisted_3","FormControl","dataImports","_hoisted_4","_hoisted_5","_Fragment","dataImport","_hoisted_7","_hoisted_8","_toDisplayString","_hoisted_9","dayjs","Badge","_hoisted_10","_cache","_hoisted_11","Dialog","Link","onUploadStep","uploadStepCompleted","_b","onMapStep","mapStepCompleted","onPreviewStep","previewStepCompleted","moveToMapStep","moveToPreviewStep","previewData","columnMappings","mappingUpdated","onMounted","initializeColumnMappings","mappings","columnToFieldMap","_c","columnsFromFile","col","index","getMappedColumnName","fieldname","columnsFromSystem","f","updateColumnMappings","value","templateOptions","nextTick","columns","parent","isParent","resetMapping","child","childField","$emit","_hoisted_6","_renderList","i","Autocomplete","val","preview","importLogs","filteredLogs","activeTab","initSocket","reloadPreviewData","getImportLogs","updatedData","d","previewColumns","align","width","row","dataMap","columnLabel","getColumnLabel","mappedFieldIndex","mappedColumnLabel","_e","_d","_g","_f","startImport","updateImportLogs","log","importSuccessCount","importErrorCount","importBannerClass","mapping","warningMap","warning","regex","match","fields","warnings","listRoute","redirectToList","pageRoute","redirectToPage","docname","tabButtons","rowMessage","map","_hoisted_12","_hoisted_14","_hoisted_15","_hoisted_16","column","_hoisted_17","rowIndex","_hoisted_18","_hoisted_19","TabButtons","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_30","_hoisted_31","_hoisted_32","Popover","_hoisted_33","_hoisted_34","show","fileType","exportType","fieldSelection","doctypeMeta","transformFields","doctypeMap","prepareDoctypeMap","addIDField","updateFieldSelection","getExportURL","exportFields","getExportFields","exportRecords","getExportType","exportPageLength","handleExport","url","blob","link","doctypeName","selectAllFields","selectMandatoryFields","unselectAllFields","Checkbox","e","importFile","googleSheet","uploading","uploadingdFile","uploaded","total","showTemplateModal","fileInput","showFileSelector","showSheetSelector","showLibrarySelector","uploadProgress","extractFile","inputFiles","dt","uploadFile","uploader","FileUploadHandler","saveImport","updateImport","createImport","exportTemplate","type","getMandatoryFields","getAllFields","exportableFields","openFileSelector","openSheetSelector","backToFileSelector","disableContinueButton","deleteFile","convertToKB","bytes","_withModifiers","_hoisted_13","Dropdown","open","TemplateModal","route","useRoute","step","createListResource","values","updateData","di","updateStep","newStep","newData","doctypeTitle","breadcrumbs","crumbs","Breadcrumbs","ImportSteps","DataImportList","UploadStep","MappingStep","PreviewStep","usePageMeta","DataImport"],"mappings":"ojCAgCA,MAAMA,EAAQC,EAKRC,EAAQC,GAA0CF,EAAA,YAAA,EAClDG,EAAOC,EAKPC,EAAQC,KACRC,EAAyBC,EAAS,IAC/B,OAAO,YACZ,OAAO,QAAQH,CAAK,EAAE,OAAO,CAAC,CAACI,CAAG,IAAMA,IAAQ,SAAWA,IAAQ,OAAO,CAAA,CAE7E,EAEKC,EAAUC,GAAe,CAC7B,IAAK,iCACL,OAAQ,CACN,QAASZ,EAAM,QACf,IAAK,GACL,QAASA,EAAM,OACjB,EACA,OAAQ,OACR,gBAAiBa,GACjB,UAAYC,GACHA,EAAK,IAAKC,IAAS,CACxB,MAAOA,EAAI,OAASA,EAAI,MACxB,MAAOA,EAAI,KACX,EAAA,CACJ,CACD,EAEKC,EAAkB,CACtB,KAAM,SACN,IAAK,aACL,MAAO,aACP,SAAU,aACV,UAAW,IAAM,GACjB,QAAS,CAAC,CAAE,WAAAC,KAAiBb,EAAK,SAAUa,CAAU,CAAA,EAGlDC,EAAcT,EAAS,IAAM,CAC3B,MAAAU,EAAWR,EAAQ,MAAQ,GACjC,OAAIX,EAAM,YACD,CAAC,GAAGmB,EAAUH,CAAe,EAE/BG,CAAA,CACR,EAEKC,EAAc,CAACC,EAAc,KAAO,CACxCV,EAAQ,OAAO,CACb,OAAQ,CACN,IAAAU,EACA,QAASrB,EAAM,QACf,QAASA,EAAM,OACjB,CAAA,CACD,EACDW,EAAQ,OAAO,CAAA,EAGXW,EAAoBC,GAAUC,GAAwB,CAC1DJ,EAAYI,GAAe,EAAE,GAC5B,GAAG,EAEA,OAAAC,GAAA,CAAC,IAAMzB,EAAM,QAAS,IAAMA,EAAM,OAAO,EAAG,IAAMoB,EAAY,EAAE,EAAG,CACvE,UAAW,GACX,KAAM,EAAA,CACP,cArGCM,EAiBM,MAAA,CAjBD,MAAMC,EAAA,CAAA,wBAAgCC,EAAAtB,CAAA,EAAM,KAAK,CAAA,EAAG,MAAKuB,GAAED,EAAKtB,CAAA,EAAC,KAAK,CAAA,GACxDwB,EAAK,WAAtBC,EAAwEC,GAAA,OAA/C,MAAOF,EAAK,MAAE,KAAK,KAAM,SAAUG,EAAQ,QAAA,yCACpEC,EAcWN,MAdXO,GAcW,YAbAjC,EAAK,2CAALA,EAAK,MAAAkC,GACb,YAAaC,EAAW,aAAA,UAAcC,EAAO,OAAA,GAC7C,QAASpB,EAAW,MACpB,QAAOU,EAAiBN,CAAA,EACxB,wBAAaF,EAAW,EAAA,GACxB,gBAAe,EAAA,EACRZ,EAAsB,MAAA,CAC7B,QAASR,EAAM,OAAA,IAEL,aAAUuC,EACnB,CAAkC,CADX,WAAAtB,KAAU,CACjCiB,EAAkCN,EAAAY,EAAA,EAAA,CAAtB,MAAM,cAAa,EAC/BC,EAA0D,OAA1DC,GAA0B,iBAAeJ,EAAO,OAAA,EAAA,CAAA,CAAA,+ECX3CK,GAAiBC,IACT,CACb,QAAW,SACX,QAAW,QACX,kBAAmB,SACnB,MAAS,MACT,YAAa,QAAA,GAEDA,CAA0B,GAAK,OAGtCC,GAAiB,CAC1B,gBACA,eACA,YACA,OACA,QACA,oBACA,SACA,QACA,OACA,SACJ,EAEaC,GAAoB,CAACR,EAAiBS,EAAuBC,IAAgB,CACtF,IAAIC,EAAiB,GAKR,OAJOD,EAAK,OAAQjC,GACtBA,EAAI,MAAQgC,CACtB,EAAE,CAAC,EAAE,OAEO,QAASG,GAAe,CAC7BA,EAAM,SAAWZ,IACjBW,EAAiBC,EAAM,UAC3B,CACJ,EACOD,CACX,EAEaE,GAAiB,CAACC,EAAoBC,EAA0BC,IAClEC,GAAK,wEAAyE,CACjF,YAAaH,EACb,YAAaC,EACb,kBAAmBC,CAAA,CACtB,EAAE,MAAOE,GAAe,OACrBC,EAAM,QAAMC,EAAAF,EAAM,WAAN,YAAAE,EAAiB,KAAMF,CAAK,EAChC,QAAA,MAAM,+BAAgCA,CAAK,CAAA,CACtD,kgBCgEC,MAAAG,EAASC,EAAI,EAAE,EACfC,EAAeD,EAAI,KAAK,EACxBE,EAAYF,EAAI,EAAK,EACrBG,EAAmBH,EAAmB,IAAI,EAE1CI,EAASC,KAETjE,EAAQC,EAIRiE,EAAgBzD,EAAS,IACX,CAAC,MAAO,UAAW,UAAW,kBAAmB,QAAS,WAAW,EACtE,IAAe0D,IAAA,CAAE,MAAOA,EAAQ,MAAOA,CAAS,EAAA,CAClE,EAEK1C,GAAA,CAACkC,EAAQE,CAAY,EAAG,CAAC,CAACO,EAAWC,CAAS,IAAM,CACtDrE,EAAM,YAAY,OAAO,CACrB,QAAS,CACLoE,EAAY,CAAC,CAAC,OAAQ,OAAQ,IAAIA,CAAS,GAAG,CAAC,EAAI,CAAC,EACpDC,IAAc,MAAQ,CAAC,CAAC,SAAU,IAAKA,CAAS,CAAC,EAAI,CAAC,GACxD,KAAK,CAAA,CACV,EACDrE,EAAM,YAAY,QAAO,CAC5B,EAEK,MAAAsE,EAAoBC,GAAsB,CACtCvE,EAAA,YAAY,OAAO,OAAO,CAC5B,kBAAmB+D,EAAiB,MACpC,YAAa,qBACb,YAAa,GACb,OAAQ,SAAA,EACT,CACC,UAAUjD,EAAkB,CACxBkD,EAAO,QAAQ,CACX,KAAM,aACN,OAAQ,CACJ,WAAYlD,EAAK,IACrB,CAAA,CACH,EACKyD,GACV,EACA,QAAQf,EAAY,OAChB,QAAQ,MAAMA,CAAK,EACnBC,EAAM,QAAMC,EAAAF,EAAM,WAAN,YAAAE,EAAiB,KAAMF,CAAK,CAC5C,CAAA,CACH,CAAA,EAGCgB,EAAoBpB,GAAuB,CAC7CY,EAAO,QAAQ,CACX,KAAM,aACN,OAAQ,CACJ,WAAAZ,CACJ,CAAA,CACH,CAAA,sBAxKD,OAAAqB,EAAA,EAAA/C,EAgGG,MAhGHgB,GAgGG,CA/FLD,EAeM,MAfNiC,GAeM,aAdLjC,EAOM,MAAA,KAAA,CANLA,EAEM,MAFD,CAAA,MAAM,4CAAA,EAA6C,eAExD,EACAA,EAEM,MAFD,CAAA,MAAM,2BAAA,EAA4B,iDAEvC,CAAA,OAEQP,EAKSyC,EAAA,CALD,QAAQ,QAAS,uBAAOb,EAAS,MAAA,GAAA,GAC1B,SACP,IAAqD,CAArD5B,EAAqD0C,EAAA,CAAxC,KAAK,OAAO,MAAM,mBAAA,eACxB,IAEf,eAFe,WAEf,EAAA,EAAA,WAGJnC,EAYM,MAZNoC,GAYM,CAXF3C,EAKE4C,GAAA,YAJWnB,EAAM,2CAANA,EAAM,MAAAvB,GACf,YAAY,wBACZ,KAAK,OACL,MAAM,iCAEVF,EAIE4C,GAAA,YAHWjB,EAAY,2CAAZA,EAAY,MAAAzB,GACrB,KAAK,SACJ,QAAS8B,EAAa,2CAIpBa,EAAAA,EAAW,YAAC,OAAZA,MAAAA,EAAkB,QAA7BN,IAAA/C,EAkCM,MAlCNsD,GAkCM,CAjCFvC,EAwBM,MAxBNwC,GAwBM,aAvBFxC,EAOM,MAAA,CAPD,MAAM,gHAA8G,CACrHA,EAEM,WAFD,QAEL,EACAA,EAEM,MAFD,CAAA,MAAM,MAAA,EAAO,UAElB,CAAA,QAEJgC,EAAA,EAAA,EAAA/C,EAcMwD,EAbmBH,KAAAA,EAAAA,EAAAA,YAAY,KAA1BI,QADXzD,EAcM,MAAA,CAZD,QAAa,IAAA8C,EAAiBW,EAAW,IAAI,EAC9C,MAAM,8FAAA,GAEN1C,EAOM,MAPN2C,GAOM,CANF3C,EAEM,MAFN4C,GACOC,EAAAH,EAAW,iBAAiB,EAAA,CAAA,EAEnC1C,EAEM,MAFN8C,GACOD,EAAA1D,EAAA4D,EAAA,EAAML,EAAW,QAAQ,EAAE,QAAO,CAAA,EAAA,CAAA,CAAA,GAG7CjD,EAAmHuD,GAAA,CAA3G,MAAON,EAAW,OAAS,MAAOvD,EAAAe,EAAA,EAAcwC,EAAW,MAAM,EAA0B,MAAM,oDAGjH1C,EAOM,MAPNiD,GAOM,CANY1F,EAAM,YAAY,iBAAhC+B,EAKS4C,EAAA,OALqC,QAAOgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAvD,GAAApC,EAAM,YAAY,KAAI,EAAA,GAC5D,SACP,IAA2D,CAA3DkC,EAA2D0C,EAAA,CAA9C,KAAK,aAAa,MAAM,mBAAA,eAC9B,IAEf,eAFe,cAEf,EAAA,EAAA,6BAGRlD,EAEM,MAFNkE,GAAwD,0BAExD,GACA1D,EAyBS2D,GAAA,YAxBI/B,EAAS,2CAATA,EAAS,MAAA1B,GACjB,QAAO,6EAAqL,MAAAmC,GAAK,CAA8BD,EAAiBC,CAAK,QAW3O,iBACP,IASM,CATN9B,EASM,MAAA,KAAA,CARFP,EAOE4D,GAAA,YANW/B,EAAgB,2CAAhBA,EAAgB,MAAA3B,GACzB,QAAQ,UACP,QAAS,eAET,EACD,MAAM,4QCrB9B,MAAMhC,EAAOC,EAEPL,EAAQC,EAKR8F,EAAetF,EAAS,IACnBT,EAAM,OAAS,QACzB,EAEKgG,EAAsBvF,EAAS,IAAM,SACvC,QAAOiD,EAAA1D,EAAM,OAAN,YAAA0D,EAAY,gBAAeuC,EAAAjG,EAAM,OAAN,YAAAiG,EAAY,kBAAA,CACjD,EAEKC,EAAYzF,EAAS,IAChBT,EAAM,OAAS,KACzB,EAEKmG,EAAmB1F,EAAS,IAAM,OAC7B,OAAAT,EAAM,QAAQ0D,EAAA1D,EAAM,OAAN,YAAA0D,EAAY,mBAAoB,KAAK,MAAM1D,EAAM,KAAK,gBAAgB,EAAE,mBAAA,CAChG,EAEKoG,EAAgB3F,EAAS,IACpBT,EAAM,OAAS,SACzB,EAEKqG,EAAuB5F,EAAS,IAAM,OACjC,QAAAiD,EAAA1D,EAAM,OAAN,YAAA0D,EAAY,UAAW,SAAA,CACjC,EAEK4C,EAAgB,IAAM,CACpBN,EAAoB,OACpB5F,EAAK,aAAc,MAAO,CAAE,GAAGJ,EAAM,KAAM,CAC/C,EAGEuG,EAAoB,IAAM,CACxBP,EAAoB,OACpB5F,EAAK,aAAc,UAAW,CAAE,GAAGJ,EAAM,KAAM,CACnD,gBA9GAyE,EAAA,EAAA/C,EA+DM,MA/DNgB,GA+DM,CA9DFD,EAmBM,MAAA,CAnBD,SAAM,0EAAyE,iCAC7BsD,EAAY,KAAA,IAGlE,QAAKJ,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAvD,GAAEhC,EAAI,aAAA,SAAA,CAAA,GAA8BU,EAAI,IAAA,CAAA,EAAA,GAEvBkF,EAAmB,WAAtCjE,EAEI6C,EAAA,OAFoC,KAAK,QAAQ,SAAM,4CAA2C,oCAA+DmB,EAAY,KAAA,2BAGjL,EAAArE,EAMM,MAAA,OANM,SAAM,6CAA4C,oCAA+DqE,EAAY,KAAA,sBAGrItD,EAEO,YAFD,MAEN,EAAA,CAAA,QAEJkD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,WAFD,gBAEL,EAAA,OAEJA,EAoBM,MAAA,CApBD,SAAM,2DAA0D,iCACdyD,EAAS,uBAAgCF,EAAmB,KAAA,IAIlH,uBAAOM,IAAa,GAEEH,EAAgB,WAAnCpE,EAEI6C,EAAA,OAFiC,KAAK,QAAQ,SAAM,4CAA2C,oCAA+DsB,EAAS,KAAA,2BAG3K,EAAAxE,EAMM,MAAA,OANM,SAAM,6CAA4C,oCAA+DwE,EAAS,KAAA,sBAGlIzD,EAEO,YAFD,MAEN,EAAA,CAAA,QAEJkD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,WAFD,aAEL,EAAA,OAEJA,EAoBM,MAAA,CApBD,SAAM,2DAA0D,iCACd2D,EAAa,uBAAgCJ,EAAmB,KAAA,IAItH,uBAAOO,IAAiB,GAEFF,EAAoB,WAAvCtE,EAEI6C,EAAA,OAFqC,KAAK,QAAQ,SAAM,4CAA2C,oCAA+DwB,EAAa,KAAA,2BAGnL,EAAA1E,EAMM,MAAA,OANM,SAAM,6CAA4C,oCAA+D0E,EAAa,KAAA,sBAGtI3D,EAEO,YAFD,MAEN,EAAA,CAAA,QAEJkD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,WAFD,oBAEL,EAAA,+eCPN,MAAA+D,EAAc5C,EAAS,IAAI,EAC3BxD,EAAOC,EACPoG,EAAiB7C,EAA4B,CAAA,CAAE,EAC/C8C,EAAiB9C,EAAI,EAAK,EAE1B5D,EAAQC,EAMd0G,GAAU,SAAY,CACNH,EAAA,MAAQ,MAAMrD,GAAenD,EAAM,KAAK,KAAOA,EAAM,KAAK,YAAaA,EAAM,KAAK,iBAAiB,EACtF4G,GAAA,CAC5B,EAED,MAAMA,EAA2B,IAAM,WACnC,MAAMC,EAAmC,CAAA,EACzC,IAAIC,EAAmB,CAAA,GACnBpD,EAAA1D,EAAM,OAAN,MAAA0D,EAAY,mBACZoD,GAAmBC,EAAA,KAAK,OAAMd,EAAAjG,EAAM,OAAN,YAAAiG,EAAY,gBAAgB,IAAvC,YAAAc,EAA2C,qBAE1D,OAAO,KAAKD,CAAgB,EAAE,OAAS,IACvCJ,EAAe,MAAQ,IAE3BM,EAAgB,MAAM,QAAQ,CAACC,EAAaC,IAAkB,CAC1DJ,GAAoBA,EAAiBI,CAAK,EAC1CL,EAASI,CAAG,EAAIE,EAAoBL,EAAiBI,CAAK,CAAC,EAE3DL,EAASI,CAAG,EAAIA,CAAA,CACvB,EAEDR,EAAe,MAAQI,CAAA,EAGrBM,EAAuBC,GAAsB,CACzC,MAAAlE,EAAQmE,EAAkB,MAAM,KAAMC,GAAWA,EAAE,OAASF,CAAS,EACvE,OAAAlE,EACOA,EAAM,MACVkE,CAAA,EAGLG,EAAuB,CAACL,EAAeM,IAAe,SACxD,GAAI,CAACA,EAAO,OACZd,EAAe,MAAQ,GACnB,IAAAe,GAAkB/D,EAAA1D,EAAM,OAAN,MAAA0D,EAAY,iBAAmB,KAAK,OAAMuC,EAAAjG,EAAM,OAAN,YAAAiG,EAAY,gBAAgB,EAAI,CAAA,EAC5Fa,EAAmBW,EAAgB,qBAA0B,CAAA,EAChDX,EAAAI,EAAQ,CAAC,EAAIM,EAAM,MAE9BxH,EAAA,YAAY,SAAS,OAAO,CAC9B,GAAGA,EAAM,KACT,iBAAkB,KAAK,UAAU,CAC7B,GAAGyH,EACH,oBAAqBX,CAAA,CACxB,CAAA,EACF,CACC,UAAYhG,GAAqB,CAC7BV,EAAK,aAAc,MAAO,CAAE,GAAGU,CAAM,CAAA,EACrC4G,GAAS,IAAM,CACcd,GAAA,CAC5B,CACL,EACA,QAAUpD,GAAe,OACrBC,EAAM,QAAMC,EAAAF,EAAM,WAAN,YAAAE,EAAiB,KAAMF,CAAK,EAChC,QAAA,MAAM,kCAAmCA,CAAK,CAC1D,CAAA,CACH,CAAA,EAGCwD,EAAkBvG,EAAS,IAAM,OACnC,MAAMkH,EAAoB,CAAA,EAC1B,OAAAjE,EAAA8C,EAAY,QAAZ,MAAA9C,EAAmB,QAAQ,QAASuD,GAAa,CACzCA,EAAI,cAAgB,UACZU,EAAA,KAAKV,EAAI,YAAY,CAAA,GAE9BU,CAAA,CACV,EAEKN,EAAoB5G,EAAS,IAAM,OACjC,MAAAmH,EAAS5H,EAAM,KAAM,kBAGpB,SAFM0D,EAAA1D,EAAM,OAAO,OAAb,YAAA0D,EAAmB,OAAQ,CAAA,GAGrC,IAAK3C,GAAa,CACX,MAAA8G,EAAW9G,EAAI,OAAS6G,EAExBD,EAAU5G,EAAI,OACjB,OAAQuG,GAAW,CAACzE,GAAe,SAASyE,EAAE,SAAS,CAAC,EACxD,IAAKA,IAAY,CAChB,MAAOA,EAAE,UACT,MAAOO,EACHP,EAAE,MACF,GAAGA,EAAE,KAAK,KAAKxE,EAAkB8E,EAAQ7G,EAAI,IAAI,CAAC,GACtD,EAAA,EAEG,MAAA,CACL,CAAE,MAAO,OAAQ,MAAO,IAAK,EAC7B,GAAG4G,CAAA,CACL,CACD,EACA,KAAK,CAAA,CACT,EAEKG,EAAe,IAAM,SACnB,IAAAL,GAAkB/D,EAAA1D,EAAM,OAAN,MAAA0D,EAAY,iBAAmB,KAAK,OAAMuC,EAAAjG,EAAM,OAAN,YAAAiG,EAAY,gBAAgB,EAAI,CAAA,EAC1FjG,EAAA,YAAY,SAAS,OAAO,CAC9B,GAAGA,EAAM,KACT,iBAAkB,KAAK,UAAU,CAC7B,GAAGyH,EACH,oBAAqB,CAAC,CAAA,CACzB,CAAA,EACF,CACC,UAAY3G,GAAqB,CAC7BV,EAAK,aAAc,MAAO,CAAE,GAAGU,CAAM,CAAA,EACrC4G,GAAS,IAAM,CACcd,GAAA,CAC5B,CACL,EACA,QAAUpD,GAAe,OACrBC,EAAM,QAAMC,EAAAF,EAAM,WAAN,YAAAE,EAAiB,KAAMF,CAAK,EAChC,QAAA,MAAM,mCAAoCA,CAAK,CAC3D,CAAA,CACH,CAAA,EAGCV,EAAoB,CAAC8E,EAAgBG,IAAkB,SAGrD,IAAAC,KAFe/B,GAAAvC,EAAA1D,EAAM,OAAO,OAAb,YAAA0D,EAAmB,KAAK,KAAM3C,GAAaA,EAAI,MAAQ6G,KAAvD,YAAA3B,EAAgE,SAAU,CAAA,GAE/D,OAAQ/C,GAAeA,EAAM,SAAW6E,CAAK,EAAE,CAAC,EAC9E,OAAOC,GAAA,YAAAA,EAAY,QAASD,CAAA,wBAvL5B,OAAAtD,EAAA,EAAA/C,EA2CM,MA3CNgB,GA2CM,CA1CHD,EAmBM,MAnBNiC,GAmBM,CAlBDjC,EAYM,MAZNoC,GAYM,CAXFpC,EAOM,MAPNuC,GAOM,CANFW,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEO,YAFD,aAEN,EAAA,IACa3B,EAAAA,EAAAA,OAAAA,MAAAA,EAAM,YAAnBiB,EAEQ0D,GAAA,OAFoB,MAAO7D,EAAAe,EAAA,GAAc7B,EAAAA,EAAAA,OAAAA,YAAAA,EAAM,MAAM,CAAA,aACzD,IAAkB,OAAA,OAAfA,EAAAA,GAAAA,EAAAA,EAAAA,OAAAA,YAAAA,EAAM,MAAM,EAAA,CAAA,CAAA,kCAGvB6E,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,MAFD,CAAA,MAAM,6BAA4B,yEAEvC,EAAA,EAAA,GAGJA,EAGM,MAHNwC,GAGM,CAFYyB,EAAc,WAA5B3E,EAA4E4C,EAAA,OAA9C,MAAM,gBAAiB,QAAOmD,CAAA,aAC5D5F,EAAmFyC,EAAA,CAA3E,MAAM,WAAW,QAAQ,QAAS,uBAAOsD,EAAK,MAAA,aAAA,SAAA,EAAA,OAIpD,OAAO,KAAKxB,EAAA,KAAc,EAAE,QAAvChC,IAAA/C,EAoBO,MApBPwG,GAoBO,aAnBFzF,EAOM,MAAA,CAPD,MAAM,uDAAqD,CAC5DA,EAEM,WAFD,kBAEL,EACAA,EAEM,WAFD,oBAEL,CAAA,OAEJA,EAUM,MAVN2C,GAUM,EATFX,EAAA,EAAA,EAAA/C,EAQWwD,EARW,KAAAiD,EAAAnB,EAAA,MAAgB,OAArBoB,iBAAmCA,GAAC,CACjD3F,EAA+D,MAA/D4C,GAAgCC,EAAA0B,EAAA,MAAgBoB,EAAC,CAAA,CAAA,EAAA,CAAA,EACjDlG,EAKEmG,GAAA,CAJG,cAAa5B,EAAA,MAAeO,EAAA,MAAgBoB,EAAC,CAAA,CAAA,EAC7C,QAASf,EAAiB,MAC3B,YAAY,eACX,sBAAqBiB,GAAaf,EAAqBa,EAAGE,CAAG,CAAA,6tDC2IhF,MAAAC,EAAU3E,EAAS,IAAI,EACvBxD,EAAOC,EACPmI,EAAa5E,EAAW,CAAA,CAAE,EAC1B6E,EAAe7E,EAAW,CAAA,CAAE,EAC5B8E,EAAY9E,EAAI,KAAK,EAErB5D,EAAQC,EAOd0G,GAAU,SAAY,OACLgC,KACN,GAAG,sBAAwB7H,GAAkC,CAChE8H,EAAkB9H,EAAK,WAAW,CAAA,CACrC,GAEI4C,EAAA1D,EAAM,OAAN,MAAA0D,EAAY,OACjB6E,EAAQ,MAAQ,MAAMpF,GAClBnD,EAAM,KAAK,KAAMA,EAAM,KAAK,YAAaA,EAAM,KAAK,iBAAA,EAEpDA,EAAM,KAAK,QAAU,WACP6I,IAClB,CACH,EAEK,MAAAD,EAAqBzD,GAAuB,CAC1CA,GAAcnF,EAAM,KAAK,MAC7B0H,GAAS,IAAM,CACX1H,EAAM,YAAY,SAClB0H,GAAS,SAAY,OACb,IAAAoB,GAAcpF,EAAA1D,EAAM,YAAY,OAAlB,YAAA0D,EAAwB,KAAUqF,GAAAA,EAAE,OAAS/I,EAAM,KAAK,MAE1EI,EAAK,aAAc,UAAW,CAAE,GAAG0I,CAAa,CAAA,EAClCD,GAAA,CACjB,CAAA,CACJ,CAAA,EAGCG,EAAiBvI,EAAS,IAAM,OAClC,MAAMkH,EAAiB,CAAA,EACvB,OAAAjE,EAAA6E,EAAQ,QAAR,MAAA7E,EAAe,QAAQ,QAAQ,CAACuD,EAAUC,IAAkB,CACxD,IAAI+B,EAAQ,OACRC,EAAQ,QACRhC,GAAS,GACTD,EAAI,aAAe,KACXgC,EAAA,SACAC,EAAA,QACDjC,EAAI,cAAgB,OACnBiC,EAAA,SAEZvB,EAAQ,KAAK,CACT,IAAKV,EAAI,aACT,MAAOA,EAAI,aACX,MAAAiC,EACA,MAAAD,CAAA,CACH,CAAA,GAEEtB,CAAA,CACV,EAEKnB,EAAc/F,EAAS,IAAM,OAC/B,MAAMK,EAA8B,CAAA,EACpC,OAAA4C,EAAA6E,EAAQ,QAAR,MAAA7E,EAAe,KAAK,QAASyF,GAAa,CACtC,MAAMC,EAA+B,CAAA,EACrC,OAAO,KAAKD,CAAG,EAAE,QAAQ,CAACzI,EAAUwG,IAAkB,CAC9C,IAAAmC,EAAcC,EAAepC,CAAK,EAClCqC,EAAmBpC,EAAoBD,CAAK,EAC5CmC,GAAe,KACfD,EAAQC,CAAW,EAAIF,EAAIzI,CAAG,EAAI,EAC3B6I,EACCH,EAAAC,CAAW,EAAIF,EAAII,CAAgB,EAEnCH,EAAAC,CAAW,EAAIF,EAAIzI,CAAG,CAClC,CACH,EACDI,EAAK,KAAKsI,CAAO,CAAA,GAEdtI,CAAA,CACV,EAEKwI,EAAkBpC,GAAkB,SAC/B,QAAAjB,GAAAvC,EAAA6E,EAAQ,QAAR,YAAA7E,EAAe,QAAQwD,KAAvB,YAAAjB,EAA+B,eAAgB,UAAUiB,EAAQ,CAAC,EAAA,EAGvEC,EAAuBD,GAAkB,mBAE3C,GAAI,GADejB,GAAAvC,EAAA6E,EAAQ,QAAR,YAAA7E,EAAe,QAAQwD,KAAvB,YAAAjB,EAA+B,cACxB,OAAA,KAC1B,IAAIuD,GAAoBC,GAAAC,GAAA3C,EAAAwB,EAAQ,QAAR,YAAAxB,EAAe,QAAQG,KAAvB,YAAAwC,EAA+B,KAA/B,YAAAD,EAAmC,MAEpD,OADiBE,GAAAC,EAAArB,EAAQ,QAAR,YAAAqB,EAAe,QAAQ,OAAQ3C,IAAaA,GAAI,cAAgBuC,GAAmB,KAAnF,YAAAG,EAAuF,aACxG,EAGLE,EAAc,IAAM,CACtBtG,GAAK,gEAAiE,CAClE,YAAavD,EAAM,KAAK,IAAA,CAC3B,CAAA,EAGC6I,EAAgB,IAAM,CACxBtF,GAAK,8DAA+D,CAChE,YAAavD,EAAM,KAAK,IAAA,CAC3B,EAAE,KAAMc,GAAe,CACpB0H,EAAW,MAAQ1H,EACnB2H,EAAa,MAAQ3H,CAAA,CACxB,CAAA,EAGCgJ,EAAmB,IAAM,CACvBpB,EAAU,OAAS,MACnBD,EAAa,MAAQD,EAAW,MACzBE,EAAU,OAAS,aAC1BD,EAAa,MAAQD,EAAW,MAAM,OAAOuB,GAAOA,EAAI,OAAO,EACxDrB,EAAU,OAAS,WAC1BD,EAAa,MAAQD,EAAW,MAAM,OAAcuB,GAAA,CAACA,EAAI,OAAO,EACpE,EAGJtI,GAAMiH,EAAW,IAAM,CACFoB,GAAA,CACpB,EAEK,MAAAE,EAAqBvJ,EAAS,IAC3B+H,EAAW,MAAM,OACfA,EAAW,MAAM,OAAcuB,GAAAA,EAAI,OAAO,EAAE,OADd,CAExC,EAEKE,EAAmBxJ,EAAS,IACzB+H,EAAW,MAAM,OACfA,EAAW,MAAM,UAAc,CAACuB,EAAI,OAAO,EAAE,OADf,CAExC,EAEKG,EAAoBzJ,EAAS,IAC3BwJ,EAAiB,OAAS,EACnB,sCACAD,EAAmB,OAAS,EAC5B,kCAEA,qCAEd,EAEKG,EAAU1J,EAAS,IAAM,SAC3B,IAAI2J,EAAyB,CAAA,EACzB,OAACnE,GAAAvC,EAAA6E,EAAQ,QAAR,YAAA7E,EAAe,WAAf,MAAAuC,EAAyB,QAC9BsC,EAAQ,MAAM,SAAS,QAAS8B,GAAiB,CACzC,GAAAA,EAAQ,MAAQ,OAAQ,CACxB,MAAMC,EAAQ,2BACV,IAAAC,EACJ,MAAMC,EAAS,CAAA,EACf,MAAQD,EAAQD,EAAM,KAAKD,EAAQ,OAAO,KAAO,MACtCG,EAAA,KAAKD,EAAM,CAAC,CAAC,EAExBH,EAAW,KAAKI,CAAM,CAC1B,CAAA,CACH,EACMJ,GAZsC,EAYtC,CACV,EAEKK,EAAWhK,EAAS,IAAM,SACrB,QAAAwF,GAAAvC,EAAA6E,EAAQ,QAAR,YAAA7E,EAAe,WAAf,YAAAuC,EAAyB,OAAQoE,GAAiBA,EAAQ,MAAQ,UAAW,EAAC,CACxF,EAEKK,EAAYjK,EAAS,IAAM,OAC7B,OAAOiD,EAAA1D,EAAM,WAAWA,EAAM,KAAK,iBAAiB,IAA7C,YAAA0D,EAAgD,SAAA,CAC1D,EAEKiH,EAAiB,IAAM,CACpBD,EAAU,QACR,OAAA,SAAS,KAAOA,EAAU,MAAA,EAG/BE,GAAYnK,EAAS,IAAM,OAC7B,OAAOiD,EAAA1D,EAAM,WAAWA,EAAM,KAAK,iBAAiB,IAA7C,YAAA0D,EAAgD,SAAA,CAC1D,EAEKmH,GAAkBC,GAAoB,CACnCF,GAAU,QACf,OAAO,SAAS,KAAOA,GAAU,MAAM,QAAQ,UAAWE,CAAO,EAAA,EAG/DC,GAAatK,EAAS,IACjB,CACH,CAAE,MAAO,MAAO,MAAO,KAAM,EAC7B,CAAE,MAAO,aAAc,MAAO,YAAa,EAC3C,CAAE,MAAO,SAAU,MAAO,QAAS,CAAA,CAE1C,EAEKuK,GAAc7B,GAAa,SAC7B,OAAOlD,GAAAvC,EAAA,KAAK,MAAMyF,EAAI,QAAQ,IAAvB,YAAAzF,EAA2B,KAA3B,YAAAuC,EAA+B,OAAA,wBAjXtC,OAAAxB,EAAA,EAAA/C,EAmKM,MAnKNgB,GAmKM,CAlKFD,EAoBM,MApBNiC,GAoBM,CAnBFjC,EAeM,MAfNoC,GAeM,CAdFpC,EAQM,MARNuC,GAQM,CAPFW,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEO,YAFD,sBAEN,EAAA,GAEAP,EAEQuD,GAAA,CAFA,MAAO7D,EAAAe,EAAA,EAAc7B,EAAAA,KAAK,MAAM,CAAA,aACpC,IAAiB,CAAdA,EAAAA,EAAAA,EAAAA,KAAK,MAAM,EAAA,CAAA,CAAA,uBAIZA,EAAAA,KAAK,QAAM,eADrBiB,EAG2C4C,EAAA,OADtC,MAAO7D,EAAI,KAAC,QAAM,UAAA,QAAA,SACnB,QAAQ,QAAS,QAAO+I,sBACTa,EAAS,WAA5B3I,EAAuE4C,EAAA,OAAzC,MAAM,OAAQ,uBAAOgG,IAAc,eAErEhF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,MAFD,CAAA,MAAM,6BAA4B,uDAEvC,EAAA,EAAA,GAGO0H,EAAA,MAAQ,QAAnB1F,EAAA,EAAA/C,EAiBM,MAjBNuD,GAiBM,CAhBFU,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,MAFD,CAAA,MAAM,2BAA0B,mBAErC,EAAA,GACAA,EAYM,MAZNyF,GAYM,QAXFxG,EAUMwD,EAAA,KAAAiD,EAVagC,EAAO,MAAdc,IAAZxG,EAAA,EAAA/C,EAUM,MAVN0D,GAUM,CATF3C,EAEM,MAFN4C,GAEMC,EADC2F,EAAG,CAAA,CAAA,EAAA,CAAA,EAEVxI,EAEM,MAFN8C,GAEM,CADFrD,EAAwE0C,EAAA,CAA3D,KAAK,cAAc,MAAM,+BAAA,KAE1CnC,EAEM,aADCwI,EAAG,CAAA,CAAA,EAAA,CAAA,CAAA,yBAMXR,EAAA,MAAS,QAApBhG,EAAA,EAAA/C,EAUM,MAVNgE,GAUM,CATFC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,MAFD,CAAA,MAAM,2BAA0B,aAErC,EAAA,GACAA,EAKM,MALNmD,GAKM,QAJFlE,EAGMwD,EAAA,KAAAiD,EAHiBsC,EAAQ,MAAnBJ,IAAZ5F,EAAA,EAAA/C,EAGM,MAHNwJ,GAGM,CAFFhJ,EAAmE0C,EAAA,CAAtD,KAAK,eAAe,MAAM,yBAAA,GACvCnC,EAA6D,MAAA,CAAxD,UAAQ4H,EAAQ,QAAS,MAAM,kBAAA,sCAKrCpE,GAAAvC,EAAA6E,EAAO,QAAP,YAAA7E,EAAS,OAAT,MAAAuC,EAAe,QAA1BxB,IAAA/C,EAoCM,MApCNyJ,GAoCM,CAnCF1I,EAkCQ,QAlCR2I,GAkCQ,CAjCJ3I,EAeQ,QAfR4I,GAeQ,CAdJ5I,EAaK,KAAA,KAAA,QAZDf,EAWKwD,EAAA,KAAAiD,EAVgBa,EAAc,MAAxBsC,QADX5J,EAWK,KAAA,CATA,IAAK4J,EAAO,IACZ,mBAAmBA,EAAO,MAAkB,UAAAA,EAAO,MAAK,EACzD,SAAM,wCAAuC,YACSA,EAAO,KAAOtC,EAAA,MAAeA,EAAc,MAAC,OAAM,CAAA,EAAK,aAA+CsC,EAAO,KAAOtC,EAAA,MAAeA,EAAc,MAAC,OAAM,CAAA,EAAK,GAAA,GAKhN,EAAA1D,EAAAgG,EAAO,KAAK,EAAA,CAAA,cAI3B7I,EAgBQ,QAhBR8I,GAgBQ,EAfJ9G,EAAA,EAAA,EAAA/C,EAcKwD,EAdyB,KAAAiD,EAAA3B,EAAA,MAAlB,CAAA2C,EAAKqC,OAAjB,EAAA9J,EAcK,KAAA,CAduC,IAAK8J,GAAQ,QACrD9J,EAYKwD,EAAA,KAAAiD,EAXgBa,EAAc,MAAxBsC,QADX5J,EAYK,KAAA,CAVA,IAAK4J,EAAO,IACZ,mBAAmBA,EAAO,MAAkB,UAAAA,EAAO,MAAK,EACzD,SAAM,8CAA6C,YACGA,EAAO,KAAOtC,EAAA,MAAeA,EAAc,MAAC,OAAM,CAAA,EAAK,GAAA,MAI7GvG,EAEM,MAFNgJ,GAEMnG,EADC6D,EAAImC,EAAO,GAAG,CAAA,EAAA,CAAA,wCAQ9BxK,EAAAA,KAAK,QAAuB,WAAA0H,EAAA,MAAW,QAAlD/D,EAAA,EAAA/C,EAsEM,MAtENgK,GAsEM,CApEF/F,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,MAFD,CAAA,MAAM,iCAAgC,gBAE3C,EAAA,GAEAA,EAEM,MAAA,CAFD,MAAKd,EAAA,CAAC,iBAAyBuI,EAAiB,KAAA,CAAA,CAC9C,EAAA5E,EAAA0E,EAAA,KAAkB,EAAG,IAAI1E,EAAA0E,EAAA,OAA2C,EAAA,MAAA,MAAA,EAAA,2BAA2B1E,EAAA2E,EAAA,KAAgB,EAAG,IAAI3E,EAAA2E,EAAA,uBAAyC,YACtK,CAAA,EAEA/H,EAAsEyJ,GAAA,CAAzD,QAASZ,GAAU,iBAAWrC,EAAS,2CAATA,EAAS,MAAAtG,GAAE,MAAM,0CAEjDqG,EAAA,MAAa,QAAxBhE,EAAA,EAAA/C,EAsDM,MAtDNkK,GAsDM,CArDFnJ,EAoDQ,QApDRoJ,GAoDQ,aAnDJpJ,EAWQ,QAAA,CAXD,MAAM,gBAAc,CACvBA,EASK,KAAA,KAAA,CARDA,EAIK,KAHD,CAAA,MAAM,iEAAA,EACT,WAED,EACAA,EAEK,KAFD,CAAA,MAAM,+CAAA,EAAgD,WAE1D,CAAA,SAGRA,EAsCQ,QAtCRqJ,GAsCQ,EArCJrH,EAAA,EAAA,EAAA/C,EAoCKwD,EApCyB,KAAAiD,EAAAM,EAAA,MAAlB,CAAAU,EAAKqC,SAAjB9J,EAoCK,KAAA,CApCwC,IAAK8J,EAAU,MAAM,OAAA,GAC9D/I,EAQK,KARLsJ,GAQK,CAPDtJ,EAMM,MANNuJ,GAMM,CALS7C,EAAI,SAAf1E,EAAA,EAAA/C,EAA0E,MAA1EuK,EAA0E,IAC1ExH,EAAA,EAAA/C,EAA4D,MAA5DwK,EAA4D,GAC5DzJ,EAEM,MADC,KAAA6C,EAAA,KAAK,MAAM6D,EAAG,WAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,CAAA,KAK7B1G,EAYK,KAZL0J,GAYK,CAXWnB,GAAW7B,CAAG,OAA1BzH,EACO,OAAA,OADsB,UAAQsJ,GAAW7B,CAAG,CAAA,cAEjC,CAAA6B,GAAW7B,CAAG,GAAM,CAAAA,EAAI,SAA1C1E,IAAA/C,EAEO,UAF4C,oBAEnD,GACiByH,EAAI,aAArBzH,EAKO,OAAA0K,GAAA,eALuB,0BAE1B,EAAA,GAAA3J,EAE6B,OAAA,CAFtB,QAAOL,GAAAyI,GAAe1B,EAAI,OAAO,EAAI,MAAKxH,EAAA,4BAAwEiJ,GAAS,KAAA,IAE3HtF,EAAA6D,EAAI,OAAO,EAAA,GAAAkD,EAAA,CAAA,eAG1B5J,EAWK,KAXL6J,GAWK,CAVcnD,EAAI,eAAnBpH,EASUwK,GAAA,OAToB,QAAQ,QAAQ,UAAU,YAAA,GACzC,SACP,IAA0C,CAA1CrK,EAA0C0C,EAAA,CAA7B,KAAK,OAAO,MAAM,QAAA,KAExB,cACP,IAEM,CAFNnC,EAEM,MAFN+J,GACOlH,EAAA6D,EAAI,SAAS,EAAA,CAAA,CAAA,gDAShDzH,EAEM,MAFN+K,GAA4C,uBAE5C,EAAA,wbC9FN,MAAAC,EAAOvM,GAAuDF,EAAA,YAAA,EAC9D0M,EAAW/I,EAAqB,KAAK,EACrCgJ,EAAahJ,EAAoD,gBAAgB,EACjFiJ,EAAiBjJ,EAA6C,CAAA,CAAE,EAChEkJ,EAAclJ,EAAS,IAAI,EAE3B5D,EAAQC,EAIRuK,EAAS5J,GAAe,CAC1B,IAAK,mCACL,OAAQ,CACJ,QAASZ,EAAM,QACf,YAAa,CACjB,EACA,KAAM,GACN,UAAUc,EAAW,CACjB,OAAAgM,EAAY,MAAQhM,EAAK,KAClBiM,EAAgBjM,CAAI,CAC/B,CAAA,CACH,EAEKiM,EAAmBjM,GAAc,CACnC,IAAIkM,EAAmF,CAAA,EAErE,OAAAC,EAAAnM,EAAK,KAAMkM,CAAU,EACvCE,EAAWF,CAAU,EACrBG,EAAqBH,CAAU,EAExBA,CAAA,EAGLC,EAAoB,CAACjK,EAAagK,IAAqF,CACpHhK,EAAA,QAASjC,GAAa,CACvBiM,EAAWjM,EAAI,IAAI,EAAIA,EAAI,OAAO,OAAQmC,GAC/B,CAACL,GAAe,SAASK,EAAM,SAAS,CAClD,EAAE,IAAKA,IACG,CACH,UAAWA,EAAM,UACjB,MAAOA,EAAM,MACb,KAAMA,EAAM,KACZ,SAAU,GAAAnC,EAAI,MAAQf,EAAM,SAAWkD,EAAM,KAAc,EAElE,CAAA,CACJ,CAAA,EAGCgK,EAAcF,GAAqF,CACrG,OAAO,KAAKA,CAAU,EAAE,QAAS1K,GAAoB,CACtC0K,EAAA1K,CAAO,EAAE,QAAQ,CACxB,UAAW,OACX,MAAO,KACP,KAAM,CAAA,CAC6C,CAAA,CAC1D,CAAA,EAGC6K,EAAwBH,GAAqF,CAC/G,OAAO,KAAKA,CAAU,EAAE,QAAS1K,GAAoB,CAC5CuK,EAAe,MAAMvK,CAAO,IACduK,EAAA,MAAMvK,CAAO,EAAI,GAC5BA,GAAWtC,EAAM,SACjBgN,EAAW1K,CAAO,EAAE,QAASY,GAAU,CAC/BA,EAAM,OACN2J,EAAe,MAAMvK,CAAO,EAAEY,EAAM,SAAS,EAAI,GACrD,CACH,EAET,CACH,CAAA,EAGCkK,EAAe,IAAM,CACvB,IAAI9K,EAAUtC,EAAM,QAChBqN,EAAeC,IACfC,EAAgBC,IAChBC,EAAmBb,EAAW,OAAS,YAAc,EAAI,GAEtD,MAAA;AAAA,mBACQ,mBAAmBtK,CAAO,CAAC;AAAA,yBACrB,mBAAmB,KAAK,UAAU+K,CAAY,CAAC,CAAC;AAAA,0BAC/C,mBAAmBE,CAAa,CAAC;AAAA,qBACtC,mBAAmBZ,EAAS,KAAK,CAAC;AAAA,8BACzBc,CAAgB,GACrC,QAAQ,OAAQ,EAAE,CAAA,EAGrBC,EAAe,SAAY,CAC7B,IAAIC,EAAMP,IAEJ,MAAAQ,EAAO,MADI,MAAM,MAAMD,CAAG,GACJ,OACtBE,EAAO,SAAS,cAAc,GAAG,EAElCA,EAAA,KAAO,IAAI,gBAAgBD,CAAI,EACpCC,EAAK,SAAW7N,EAAM,SAAW2M,EAAS,QAAU,MAAQ,OAAS,SAC5D,SAAA,KAAK,YAAYkB,CAAI,EAE9BA,EAAK,MAAM,EACF,SAAA,KAAK,YAAYA,CAAI,CAAA,EAG5BP,EAAkB,IAAM,CAC1B,IAAID,EAAyC,CAAA,EAC7C,cAAO,KAAKR,EAAe,KAAK,EAAE,QAASvK,GAAoB,CACvD,IAAAwL,EAAcxL,GAAWtC,EAAM,QAAUsC,EAAUQ,GAAkBR,EAAStC,EAAM,QAAS8M,EAAY,KAAK,EAClHO,EAAaS,CAAW,EAAI,OAAO,KAAKjB,EAAe,MAAMvK,CAAO,CAAC,EAAE,OAAQ8E,GAAsByF,EAAe,MAAMvK,CAAO,EAAE8E,CAAS,CAAC,CAAA,CAChJ,EACMiG,CAAA,EAGLG,EAAgB,IACdZ,EAAW,OAAS,iBACb,iBACPA,EAAW,OAAS,YACb,YACJ,MAGLmB,EAAkB,IAAM,CAC1B,OAAO,KAAKvD,EAAO,IAAI,EAAE,QAASlI,GAAoB,CAClDkI,EAAO,KAAKlI,CAAO,EAAE,QAASY,GAAoB,CACzC2J,EAAe,MAAMvK,CAAO,IACduK,EAAA,MAAMvK,CAAO,EAAI,IAEpCuK,EAAe,MAAMvK,CAAO,EAAEY,EAAM,SAAS,EAAI,EAAA,CACpD,CAAA,CACJ,CAAA,EAGC8K,EAAwB,IAAM,CAChC,OAAO,KAAKxD,EAAO,IAAI,EAAE,QAASlI,GAAoB,CAClDkI,EAAO,KAAKlI,CAAO,EAAE,QAASY,GAAoB,CAC/B2J,EAAA,MAAMvK,CAAO,EAAEY,EAAM,SAAS,EAAI,EAAAA,EAAM,IAAc,CACxE,CAAA,CACJ,CAAA,EAGC+K,EAAoB,IAAM,CAC5B,OAAO,KAAKzD,EAAO,IAAI,EAAE,QAASlI,GAAoB,CAClDkI,EAAO,KAAKlI,CAAO,EAAE,QAASY,GAAoB,CAC9C2J,EAAe,MAAMvK,CAAO,EAAEY,EAAM,SAAS,EAAI,EAAA,CACpD,CAAA,CACJ,CAAA,oBAlNDnB,EAuDS8D,GAAA,YAvDQ6G,EAAI,2CAAJA,EAAI,MAAAtK,GAAG,QAAS,+BAGhC,CAAA,GACc,iBACP,IA0CM,CA1CNK,EA0CM,MA1CNC,GA0CM,CAzCFD,EAOM,MAPNiC,GAOM,CANFxC,EAKE4C,GAAA,CAJE,MAAM,uBACG6H,EAAQ,2CAARA,EAAQ,MAAAvK,GAChB,QAAS,CAAgB,QAAA,KAAA,EAC1B,KAAK,mCAGbK,EAgCM,MAhCNoC,GAgCM,CA/BFc,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEI,IAFD,CAAA,MAAM,wBAAuB,2DAEhC,EAAA,GACAA,EAIM,MAJNuC,GAIM,CAHF9C,EAAsDyC,EAAA,CAA9C,MAAM,aAAc,QAAOoJ,CAAA,GACnC7L,EAAyEyC,EAAA,CAAjE,MAAM,0BAA2B,QAAOqJ,CAAA,GAChD9L,EAA0DyC,EAAA,CAAlD,MAAM,eAAgB,QAAOsJ,CAAA,KAEzCxL,EAsBM,MAtBNwC,GAsBM,QArBFvD,EAoBMwD,EAAA,KAAAiD,EApBiB,OAAO,KAAKvG,EAAM4I,CAAA,EAAC,IAAI,EAAlClI,QAAZZ,EAoBM,MAAA,CApB4C,IAAKY,EAAS,MAAM,yBAAA,GAClEG,EAEM,MAFNyF,GAEM5C,EADChD,CAAO,EAAA,CAAA,EAEdG,EAeM,MAfN2C,GAeM,EAdFX,EAAA,EAAA,EAAA/C,EAaMwD,SAbetD,EAAM4I,CAAA,EAAC,KAAKlI,CAAO,EAA5BY,QAAZxB,EAaM,MAAA,CAbsC,IAAKwB,EAAM,UAAW,MAAM,6BAAA,GACpEhB,EAIMgM,GAAA,CAHD,GAAgB,YAAA5L,CAAO,IAAIY,EAAM,SAAS,GAC1C,QAAS2J,EAAc,MAACvK,CAAO,EAAEY,EAAM,SAAS,EAChD,SAASiL,IAAatB,EAAA,MAAevK,CAAO,EAAEY,EAAM,SAAS,EAAKiL,GAAE,OAA4B,OAAA,sCAErG1L,EAMQ,QAAA,CALH,IAAiB,YAAAH,CAAO,IAAIY,EAAM,SAAS,GAC3C,MAAKvB,EAAA,CAAkE,iBAAAuB,EAAM,IAAA,IAG3EoC,EAAApC,EAAM,OAASA,EAAM,SAAS,EAAA,GAAAmC,EAAA,CAAA,+BAStD,QAAO9C,EACd,CAGM,CAJY,MAAAgC,KAAK,CACvB9B,EAGM,MAHN8C,GAGM,CAFFrD,EAA+DyC,EAAA,CAAvD,MAAM,SAAS,QAAQ,QAAS,QAAO+I,CAAA,GAC/CxL,EAAwCyC,EAAA,CAAhC,MAAM,SAAU,QAAOJ,o1CCgH/C,MAAMnE,EAAOC,EACP+N,EAAaxK,EAAgB,IAAI,EACjCyK,EAAczK,EAAY,EAAE,EAC5B0K,EAAY1K,EAAI,EAAK,EACrB2K,EAAiB3K,EAAgB,IAAI,EACrC4K,EAAW5K,EAAI,CAAC,EAChB6K,EAAQ7K,EAAI,CAAC,EACb8K,EAAoB9K,EAAI,EAAK,EAC7B+K,EAAY/K,EAA6B,IAAI,EAC7CgL,EAAmBhL,EAAI,EAAI,EAC3BiL,EAAoBjL,EAAI,EAAK,EAC7BkL,EAAsBlL,EAAI,EAAK,EAC/BI,EAASC,KAETjE,EAAQC,EAOR8O,EAAiBtO,EAAS,IACxBgO,EAAM,QAAU,EAAU,EACvB,KAAK,MAAOD,EAAS,MAAQC,EAAM,MAAS,GAAG,CACzD,EAEKO,EAAeb,GAA0B,SACrC,MAAAc,GAAcvL,EAAAyK,EAAE,SAAF,YAAAzK,EAA+B,MAC7CwL,GAAMjJ,EAAAkI,EAAgB,eAAhB,YAAAlI,EAA8B,MAE1C,OAAOgJ,GAAA,YAAAA,EAAa,MAAMC,GAAA,YAAAA,EAAK,KAAM,IAAA,EAGnCC,EAAchB,GAAa,CACvB,MAAA9K,EAAO2L,EAAYb,CAAC,EAC1B,GAAI,CAAC9K,EAAM,OAEP,GAAAA,EAAK,OAAS,WAAY,CAC1BI,EAAM,MAAM,iCAAiC,EAC7C,QAAQ,MAAM,iCAAiC,EAC/C,MACJ,CAEA8K,EAAe,MAAQlL,EACjB,MAAA+L,EAAW,IAAIC,GAEZD,EAAA,GAAG,QAAS,IAAM,CACvBd,EAAU,MAAQ,EAAA,CACrB,EAEQc,EAAA,GAAG,WAAatO,GAA8C,CACnE0N,EAAS,MAAQ1N,EAAK,SACtB2N,EAAM,MAAQ3N,EAAK,KAAA,CACtB,EAEQsO,EAAA,GAAG,QAAU5L,GAAe,CACjC8K,EAAU,MAAQ,GAClB7K,EAAM,MAAMD,CAAK,EACT,QAAA,MAAM,qBAAsBA,CAAK,CAAA,CAC5C,EAEQ4L,EAAA,GAAG,SAAU,IAAM,CACxBd,EAAU,MAAQ,EAAA,CACrB,EACDc,EAAS,OAAO/L,EAAM,CAAE,CAAA,EAAE,KAAcvC,GAAA,CACpCsN,EAAW,MAAQtN,CAAA,CACrB,EAAE,MAAe0C,GAAA,CACP,QAAA,MAAM,qBAAsBA,CAAK,CAAA,CAC5C,CAAA,EAGC8L,EAAa,IAAM,QACjB5L,EAAA1D,EAAM,OAAN,MAAA0D,EAAY,KACC6L,IAEAC,GACjB,EAGEA,EAAe,IAAM,OACjBxP,EAAA,YAAY,OAAO,OAAO,CAC5B,kBAAmBA,EAAM,QACzB,YAAa,qBACb,YAAa,GACb,OAAQ,UACR,kBAAmBqO,EAAY,MAAM,KAAK,EAC1C,aAAa3K,EAAA0K,EAAW,QAAX,YAAA1K,EAAkB,QAAA,EAChC,CACC,UAAU5C,EAAkB,CACxBkD,EAAO,QAAQ,CACX,KAAM,aACN,OAAQ,CACJ,WAAYlD,EAAK,IACrB,EACA,MAAO,CACH,KAAM,KACV,CAAA,CACH,CACL,EACA,QAAQ0C,EAAY,OAChBC,EAAM,QAAMC,EAAAF,EAAM,WAAN,YAAAE,EAAiB,KAAMF,CAAK,EAChC,QAAA,MAAM,8BAA+BA,CAAK,CACtD,CAAA,CACH,CAAA,EAGC+L,EAAe,IAAM,CAClBvP,EAAM,MACLA,EAAA,YAAY,SAAS,OAAO,CAC9B,GAAGA,EAAM,KACT,kBAAmBqO,EAAY,MAAM,KAAK,EAC1C,YAAaD,EAAW,MAAQA,EAAW,MAAM,SAAW,EAAA,EAC7D,CACC,UAAUtN,EAAkB,CACxB4G,GAAS,IAAM,CACP0G,EAAW,OAASC,EAAY,MAAM,OAAO,OACxCjO,EAAA,aAAc,MAAOU,CAAI,EAEzBV,EAAA,aAAc,SAAUU,CAAI,CACrC,CACH,CACL,EACA,QAAQ0C,EAAY,OACVC,EAAA,QAAMC,EAAAF,EAAM,WAAN,YAAAE,EAAiB,KAAMF,EAAO,CAAE,SAAU,GAAA,CAAM,EACpD,QAAA,MAAM,8BAA+BA,CAAK,CACtD,CAAA,CACH,CAAA,EAGCiM,EAAiB,MAAOC,GAA8B,CACpD,IAAA/B,EAAMP,GAAasC,CAAI,EAErB,MAAA9B,EAAO,MADI,MAAM,MAAMD,CAAG,GACJ,OACtBE,EAAO,SAAS,cAAc,GAAG,EAElCA,EAAA,KAAO,IAAI,gBAAgBD,CAAI,EAC/BC,EAAA,SAAW7N,EAAM,QAAU,OACvB,SAAA,KAAK,YAAY6N,CAAI,EAE9BA,EAAK,MAAM,EACF,SAAA,KAAK,YAAYA,CAAI,CAAA,EAG5BT,GAAgBsC,GAA8B,SAChD,GAAI,CAAC1P,EAAM,SAAW,GAAC0D,EAAA1D,EAAM,OAAN,MAAA0D,EAAY,mBAA0B,MAAA,GACzD,IAAA2J,EAAeC,GAAgBoC,CAAI,EAEhC,MAAA;AAAA,mBACQ,mBAAmB1P,EAAM,WAAWiG,EAAAjG,EAAM,OAAN,YAAAiG,EAAY,kBAA2B,CAAC;AAAA,yBACtE,mBAAmB,KAAK,UAAUoH,CAAY,CAAC,CAAC;AAAA;AAAA,wBAGhE,QAAQ,OAAQ,EAAE,CAAA,EAGrBC,GAAmBoC,GAEjBA,GAAQ,YACDC,GAAmB,EAEvBC,GAAa,EAGlBD,GAAqB,IAAM,SAE7B,IAAIE,IADgBnM,EAAA1D,EAAM,OAAO,OAAb,YAAA0D,EAAmB,KAAK,KAAM3C,GAAaA,EAAI,MAAQf,EAAM,UAC5C,OAAO,OAAQkD,GACzC,CAACL,GAAe,SAASK,EAAM,SAAS,GAAKA,EAAM,IAC7D,EAAE,IAAKA,GAAoBA,EAAM,SAAS,EAC3C,OAAA2M,EAAiB,QAAQ,MAAM,EACxB,CACH,CAAC7P,EAAM,WAAWiG,EAAAjG,EAAM,OAAN,YAAAiG,EAAY,kBAA2B,EAAG4J,CAAA,CAChE,EAGED,GAAe,IAAM,OACvB,IAAI5C,EAAuC,CAAA,EACvChK,IAAOU,EAAA1D,EAAM,OAAO,OAAb,YAAA0D,EAAmB,OAAQ,CAAA,EACjC,OAAAV,EAAA,QAASjC,GAAa,OACvB,IAAI8O,EAAmB9O,EAAI,OAAO,OAAQmC,IAC/B,CAACL,GAAe,SAASK,GAAM,SAAS,CAClD,EAAE,IAAKA,IAAoBA,GAAM,SAAS,EAC3C2M,EAAiB,QAAQ,MAAM,EAC/B,IAAI/B,GAAc/M,EAAI,MAAQf,EAAM,QAAUe,EAAI,KAAO+B,GAAkB/B,EAAI,KAAMf,EAAM,WAAW0D,EAAA1D,EAAM,OAAN,YAAA0D,EAAY,mBAA6BV,CAAI,EACnJgK,EAAWc,EAAW,EAAI+B,CAAA,CAC7B,EACM7C,CAAA,EAGL8C,EAAmB,IAAM,QAC3BpM,EAAAiL,EAAU,QAAV,MAAAjL,EAAiB,OAAM,EAGrBqM,EAAoB,IAAM,CAC5BnB,EAAiB,MAAQ,GACzBE,EAAoB,MAAQ,GAC5BD,EAAkB,MAAQ,EAAA,EAGxBmB,EAAqB,IAAM,CAC7BpB,EAAiB,MAAQ,GACzBE,EAAoB,MAAQ,GAC5BD,EAAkB,MAAQ,EAAA,EAGxBoB,EAAwBxP,EAAS,IAC5B,CAAC2N,EAAW,OAAS,CAACC,EAAY,MAAM,KAAO,EAAA,MACzD,EAEK5M,GAAA,IAAMzB,EAAM,KAAM,IAAM,CACtBA,EAAM,OACFA,EAAM,KAAK,YACAoO,EAAA,MAAQpO,EAAM,KAAK,YACvBA,EAAM,KAAK,oBACA+P,IACN1B,EAAA,MAAQrO,EAAM,KAAK,mBAEvC,EACD,CAAE,UAAW,EAAA,CAAM,EAEtByB,GAAM,CAAC2M,EAAYC,CAAW,EAAG,IAAM,EAC/B,CAACD,EAAW,OAAS,CAACC,EAAY,MAAM,OAAO,SAClCkB,GACjB,CACH,EAED,MAAMW,EAAa,IAAM,CACrB9B,EAAW,MAAQ,IAAA,EAGjB+B,EAAeC,IACTA,EAAQ,MAAM,QAAQ,CAAC,EAAI,iCA1YnC,OAAA3L,EAAA,EAAA/C,EAqJM,MArJNgB,GAqJM,CApJFD,EAqBM,MArBNiC,GAqBM,CApBFjC,EAgBM,MAhBNoC,GAgBM,CAfFpC,EAOM,MAPNuC,GAOM,CANFW,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEO,YAFD,kBAEN,EAAA,IACa3B,EAAAA,EAAAA,OAAAA,MAAAA,EAAM,YAAnBiB,EAEQ0D,GAAA,OAFoB,MAAO7D,EAAAe,EAAA,GAAc7B,EAAAA,EAAAA,OAAAA,YAAAA,EAAM,MAAM,CAAA,aACzD,IAAkB,OAAA,OAAfA,EAAAA,GAAAA,EAAAA,EAAAA,OAAAA,YAAAA,EAAM,MAAM,EAAA,CAAA,CAAA,kCAGvBoB,EAMSyC,EAAA,CALL,QAAQ,QACP,QAAO2K,EACP,SAAUW,EAAqB,KAAA,aACnC,IAED,CAAA,GAAAtK,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAFC,aAED,EAAA,6BAEJA,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAlD,EAEM,MAFD,CAAA,MAAM,aAAY,mEAEvB,EAAA,EAAA,GAGJA,EAsHM,MAtHNwC,GAsHM,CApHQ2J,EAAA,QAAqBR,EAAU,WADzC1M,EAuCM,MAAA,OArCD,0BAAD,IAAiB,CAAA,EAAA,CAAA,SAAA,CAAA,GAChB,OAAeiE,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA0K,GAAAlC,GAAOgB,EAAWhB,CAAC,EAAA,CAAA,SAAA,CAAA,GACnC,MAAM,oHAAA,GACKS,EAAA,QAAqBN,EAAS,OAAzC7J,IAAA/C,EAiBM,MAjBNwG,GAiBM,CAhBFhG,EAA4F0C,EAAA,CAA/E,KAAK,eAAe,MAAM,kDAAA,GACvCnC,EAME,QAAA,SALM,YAAJ,IAAIkM,EACJ,KAAK,OACL,OAAO,OACP,MAAM,SACL,SAAShJ,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAwI,GAAMgB,EAAWhB,CAAC,EAAA,YAEhC1L,EAOM,MAAA,CAPD,MAAM,6BAA2B,eAAC,kDAEnC,EAAA,GAAAA,EAAkG,OAAA,CAA3F,QAAOqN,EAAkB,MAAM,gDAA+C,QAAM,gBAAO,OAElG,EAAA,GAAArN,EAEO,OAAA,CAFA,QAAOsN,EAAmB,MAAM,gDAA+C,gBAEtF,CAAA,MAGQnB,EAAA,OAAoBN,EAAS,OAA7C7J,IAAA/C,EAeM,MAfN0D,GAeM,CAdF3C,EAOM,MAPN4C,GAOM,CANF5C,EAEM,MAFN8C,GACOD,EAAAiJ,EAAA,MAAe,IAAI,EAAA,CAAA,EAE1B9L,EAEM,MAFNiD,GAEMJ,EADC6K,EAAY3B,EAAQ,KAAA,CAAA,EAAI,OAAIlJ,EAAG6K,EAAY1B,EAAK,KAAA,CAAA,EAAA,CAAA,CAAA,GAG3DhM,EAKM,MALNmD,GAKM,CAJFnD,EAGO,MAAA,CAFH,MAAM,6EACL,mBAAiBsM,EAAc,KAAA,GAAA,CAAA,8BAKhCX,EAAU,OAA1B3J,EAAA,EAAA/C,EAgBM,MAhBNwJ,GAgBM,CAfFzI,EAcM,MAdN6N,GAcM,CAbF7N,EAOM,MAPN0I,GAOM,CANF1I,EAEM,MAFN2I,GAEM9F,EADC8I,EAAU,MAAC,WAAaA,EAAU,MAAC,MAAK,GAAA,EAAM,IAAG,CAAA,EAAA,CAAA,EAE7CA,EAAA,MAAW,WAAtB3J,EAAA,EAAA/C,EAEM,MAFN2J,GAEM/F,EADC6K,EAAY/B,EAAA,MAAW,SAAS,CAAA,EAAA,CAAA,cAG3ClM,EAIE0C,EAAA,CAHE,KAAK,UACL,MAAM,kDACL,QAAOsL,CAAA,QAKJrB,EAAiB,OAAjCpK,EAAA,EAAA/C,EAkBM,MAlBN6J,GAkBM,CAjBF9I,EAKM,MALNgJ,GAKM,CAJFvJ,EAA6F0C,EAAA,CAAhF,KAAK,eAAe,MAAM,wBAAyB,QAAOoL,CAAA,GACvErK,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAlD,EAEM,WAFD,iBAEL,EAAA,EAAA,GAEJA,EAUM,MAVNiJ,GAUM,IATFjJ,EAKE,QAAA,sCAJW4L,EAAW,MAAAjM,GACpB,KAAK,OACL,MAAM,kEACN,YAAY,wBAAA,iBAHHiM,EAAW,KAAA,CAAA,GAKxB1I,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAlD,EAEM,MAFD,CAAA,MAAM,mBAAkB,mEAE7B,EAAA,EAAA,eAIRA,EAsCM,MAtCNmJ,GAsCM,CArCF1J,EAoCWqO,GAAA,CAnCN,QAAO,qCAA6Jd,EAAc,WAAA,kCAA2NA,EAAc,KAAA,uCAA0Nf,EAAiB,MAAA,QAsBnoB,QAAAnM,EAAA,CAWS,CAZO,KAAAiO,KAAI,CACpBtO,EAWSyC,EAAA,CAXD,QAAQ,SAAO,CACR,SACP,IAAyD,CAAzDzC,EAAyD0C,EAAA,CAA5C,KAAK,WAAW,MAAM,mBAAA,KAG5B,SACP,IAGK,CAHL1C,EAGK0C,EAAA,CAHQ,KAAK,eAAgB,MAAKjD,EAAA,0DAAsI6O,EAAI,aAAA,EAAA,kCAH1K,IAEX,iBAFW,0BAEX,EAAA,EAAA,wCAaVxQ,EAAM,UAAW+G,EAAA/G,EAAM,OAAN,MAAA+G,EAAY,uBADvChF,EAIE0O,GAAA,kBAFW/B,EAAiB,2CAAjBA,EAAiB,MAAAtM,GACzB,QAASpC,EAAM,WAAW0J,GAAA1J,EAAM,OAAN,YAAA0J,GAAY,kBAAA,uRC7FnD,MAAMgH,EAAQC,KACRC,EAAOhN,EAA2C,MAAM,EACxD9C,EAAO8C,EAAuB,IAAI,EAElC5D,EAAQC,EAEN8E,EAAc8L,GAAmB,CACvC,QAAS,cACT,OAAQ,CACN,OACA,oBACA,cACA,SACA,WACA,cACA,cACA,oBACA,kBACF,EACA,KAAM,GACN,QAAS,eAAA,CACV,EAEKrG,EAAS5J,GAAe,CAC5B,IAAK,mCACL,WAAakQ,IACJ,CACL,QAASA,EAAO,QAChB,YAAa,CAAA,GAGjB,KAAM,EAAA,CACP,EAGKC,EAAa,IAAM,OAClBjQ,EAAA,QAAQ4C,EAAAqB,EAAY,OAAZ,YAAArB,EAAkB,KAC5BsN,GAAmBA,EAAG,OAAShR,EAAM,cACjC,IAAA,EAGTyB,GACE,IAAM,CAACiP,EAAM,OAAQ1Q,EAAO+E,EAAY,IAAI,EAC5C,IAAM,aACA/E,EAAM,SACR4Q,EAAK,MAAQ,SACbpG,EAAO,OAAO,CACZ,QAASkG,EAAM,OAAO,OAAA,CACvB,GACQ1Q,EAAM,aACJ+Q,IACP,GAACrN,EAAA5C,EAAK,QAAL,MAAA4C,EAAY,cAAe,GAACuC,EAAAnF,EAAK,QAAL,MAAAmF,EAAY,mBAC3C2K,EAAK,MAAQ,SACJA,EAAK,OAAS,UAAYF,EAAM,MAAM,MAAQ,MAClDE,EAAA,MAAQF,EAAM,MAAM,KAEzBE,EAAK,MAAQ,WAEX7J,EAAAjG,EAAK,QAAL,MAAAiG,EAAY,mBACdyD,EAAO,OAAO,CACZ,SAASd,EAAA5I,EAAK,QAAL,YAAA4I,EAAY,iBAAA,CACtB,EAGP,EACA,CAAE,UAAW,EAAK,CAAA,EAGdjI,GAAA,IAAMiP,EAAM,MAAO,IAAM,CACzBA,EAAM,MAAM,MAAQ,SACtBE,EAAK,MAAQ,OACf,CACD,EAEK,MAAAK,EAAa,CAACC,EAAgDC,IAAwB,CAC1FP,EAAK,MAAQM,EACTC,IACFrQ,EAAK,MAAQqQ,EACf,EAGIC,EAAe3Q,EAAS,IAAM,WAClC,IAAI6B,EAAUtC,EAAM,WAAW0D,EAAA5C,EAAK,QAAL,YAAA4C,EAAY,mBAC3C,QAAOqD,GAAAd,EAAAjG,EAAM,aAAN,YAAAiG,EAAmB3D,GAAW,MAA9B,YAAAyE,EAAmC,QAASzE,GAAW,EAAA,CAC/D,EAEK+O,EAAc5Q,EAAS,IAAM,CACjC,IAAI6Q,EAAS,CACX,CACE,MAAO,cACP,MAAO,CACL,KAAM,iBACN,MAAO,CACL,KAAM,MACR,CACF,CACF,CAAA,EAGE,OAAAV,EAAK,QAAU,QACjBU,EAAO,KAAK,CACV,MAAO,aAAaF,EAAa,KAAK,EAAA,CACvC,EAGIE,CAAA,CACR,2CAhKC7O,EAKS,SALTC,GAKS,CAFLR,EAAoCqP,GAAA,CAAtB,MAAOF,EAAW,KAAA,EAAA,KAAA,EAAA,CAAA,OAAA,CAAA,EACiBT,EAAI,OAAA,YAArD7O,EAAsHyP,GAAA,OAAzG,MAAM,wBAA+C,KAAM1Q,EAAI,MAAG,KAAM8P,EAAI,MAAG,aAAYK,CAAA,sCAE5GxO,EAkCM,MAAA,KAAA,CAjC+DmO,EAAI,OAAA,YAArE7O,EAAsIyP,GAAA,OAAzH,MAAM,wCAA+D,KAAM1Q,EAAI,MAAG,KAAM8P,EAAI,MAAG,aAAYK,CAAA,oCAGlHL,EAAI,QAAA,YADZ7O,EAIE0P,GAAA,OAFC,YAAa7P,EAAWmD,CAAA,EACxB,aAAYkM,4BAIFL,EAAI,QAAA,cADjB7O,EAOE2P,GAAA,OALC,YAAa9P,EAAWmD,CAAA,EACxB,QAASzC,EAAAA,WAAWoB,EAAA5C,EAAA,QAAA,YAAA4C,EAAM,mBAC1B,OAAQ9B,EAAM4I,CAAA,EACd,KAAM1J,EAAI,MACV,aAAYmQ,CAAA,qDAIFL,EAAI,QAAA,WADjB7O,EAME4P,GAAA,OAJC,YAAa/P,EAAWmD,CAAA,EACxB,KAAMjE,EAAI,MACV,OAAQc,EAAM4I,CAAA,EACd,aAAYyG,4CAIFL,EAAI,QAAA,eADjB7O,EAOE6P,GAAA,OALC,YAAahQ,EAAWmD,CAAA,EACxB,KAAMjE,EAAI,MACV,OAAQc,EAAM4I,CAAA,EACd,WAAYwC,EAAU,WACtB,aAAYiE,8GC1BnB,MAAMP,EAAQC,GAAS,EAEjB3D,EAAa,CACjB,WAAY,CACV,MAAO,QACP,UAAW,aACX,UAAW,oBACZ,EACD,WAAY,CACV,MAAO,QACP,UAAW,aACX,UAAW,oBACZ,EACD,QAAS,CACP,MAAO,WACP,UAAW,gBACX,UAAW,uBACZ,EACD,WAAY,CACV,MAAO,QACP,UAAW,YACZ,EACD,mBAAoB,CAClB,MAAO,gBACP,UAAW,qBACX,UAAW,4BACZ,EACD,eAAgB,CACd,MAAO,WACP,UAAW,gBACZ,CACH,EAEA,OAAA6E,GAAY,KACH,CACL,MAAO,GAAG,aAAa,CACzB,EACD,cAjDC9P,EAIEH,EAAAkQ,EAAA,EAAA,CAHC,QAASlQ,EAAA8O,CAAA,EAAM,OAAO,QACtB,WAAY9O,EAAA8O,CAAA,EAAM,OAAO,WACzB,WAAY1D","x_google_ignoreList":[0,1,2,3,4,5,6,7,8]}