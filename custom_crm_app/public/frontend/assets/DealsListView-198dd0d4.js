import{L,W as T,M as x,x as V,X as q,y as H,l as N,r as b,b as s,c as r,d as i,w as c,u as d,F as B,f as P,g as m,n as f,A as k,Y as S,U as O,e as j,t as F}from"./index-60fe5464.js";import{H as M,_ as E}from"./ListBulkActions-20c42b53.js";import{_ as J}from"./MultipleAvatar-59dbe3ef.js";import{I as X}from"./IndicatorIcon-04037c64.js";import{P as Y}from"./PhoneIcon-69e5860b.js";import{_ as G}from"./DeleteLinkedDocModal-975a2092.js";import{L as K,a as Q,b as Z,c as ee,d as te}from"./ListView-018dab64.js";import{a as z}from"./index-0265294d.js";import{L as se}from"./ListFooter-09ef4448.js";import{D as oe}from"./dayjs-94ac47e4.js";const le={key:0,class:"flex items-center"},ae={key:0},ie={key:1},ne={key:2},re={key:3},de={key:4},ue=["onClick"],ce={key:1,class:"truncate text-base"},me={key:2},ke=["onClick"],Le={__name:"DealsListView",props:L({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:L(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(a,{expose:A,emit:U}){const u=U,g=T(),y=x(a,"modelValue"),C=x(a,"list"),D=V(()=>{var n,o;return!!((o=(n=C.value.params)==null?void 0:n.filters)!=null&&o._liked_by)}),{user:$}=q();function h(n){if(n)return JSON.parse(n).includes($)}H(y,(n,o)=>{n!==o&&u("updatePageCount",n)});const v=N(null);return A({customListActions:V(()=>{var n;return(n=v.value)==null?void 0:n.customListActions})}),(n,o)=>{const _=b("Button"),I=b("Badge"),R=b("FormControl");return s(),r(B,null,[i(d(te),{class:f(n.$attrs.class),columns:a.columns,rows:a.rows,options:{getRowRoute:e=>({name:"Deal",params:{dealId:e.name},query:{view:d(g).query.view,viewType:d(g).params.viewType}}),selectable:a.options.selectable,showTooltip:a.options.showTooltip,resizeColumn:a.options.resizeColumn},"row-key":"name","onUpdate:selections":o[2]||(o[2]=e=>u("selectionsChanged",e))},{default:c(()=>[i(d(K),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:o[1]||(o[1]=e=>u("columnWidthUpdated"))},{default:c(()=>[(s(!0),r(B,null,P(a.columns,e=>(s(),m(d(Q),{key:e.key,item:e,onColumnWidthUpdated:l=>u("columnWidthUpdated",e)},{default:c(()=>[e.key=="_liked_by"?(s(),m(_,{key:0,variant:"ghosted",class:f(["!h-4",D.value?"fill-red-500":"fill-white"]),onClick:o[0]||(o[0]=()=>u("applyLikeFilter"))},{default:c(()=>[i(M,{class:"h-4 w-4"})]),_:1},8,["class"])):k("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),i(G,{rows:a.rows,doctype:"CRM Deal"},{default:c(({idx:e,column:l,item:t,row:W})=>[l.key==="_assign"?(s(),r("div",le,[i(J,{avatars:t,size:"sm",onClick:w=>u("applyFilter",{event:w,idx:e,column:l,item:t,firstColumn:a.columns[0]})},null,8,["avatars","onClick"])])):(s(),m(d(Z),{key:1,item:t,align:l.align},{prefix:c(()=>[l.key==="status"?(s(),r("div",ae,[i(X,{class:f(t.color)},null,8,["class"])])):l.key==="organization"?(s(),r("div",ie,[t.label?(s(),m(d(z),{key:0,class:"flex items-center",image:t.logo,label:t.label,size:"sm"},null,8,["image","label"])):k("",!0)])):l.key==="deal_owner"?(s(),r("div",ne,[t.full_name?(s(),m(d(z),{key:0,class:"flex items-center",image:t.user_image,label:t.full_name,size:"sm"},null,8,["image","label"])):k("",!0)])):l.key==="mobile_no"?(s(),r("div",re,[i(Y,{class:"h-4 w-4"})])):l.key==="_liked_by"?(s(),r("div",de,[l.key=="_liked_by"?(s(),m(_,{key:0,variant:"ghosted",class:f(h(t)?"fill-red-500":"fill-white"),onClick:S(()=>u("likeDoc",{name:W.name,liked:h(t)}),["stop","prevent"])},{default:c(()=>[i(M,{class:"h-4 w-4"})]),_:1},8,["class","onClick"])):k("",!0)])):k("",!0)]),default:c(({label:w})=>[["modified","creation","first_response_time","first_responded_on","response_by"].includes(l.key)?(s(),r("div",{key:0,class:"truncate text-base",onClick:p=>u("applyFilter",{event:p,idx:e,column:l,item:t,firstColumn:a.columns[0]})},[i(d(O),{text:t.label},{default:c(()=>[j("div",null,F(t.timeAgo),1)]),_:2},1032,["text"])],8,ue)):l.key==="sla_status"?(s(),r("div",ce,[t.value?(s(),m(I,{key:0,variant:"subtle",theme:t.color,size:"md",label:t.value,onClick:p=>u("applyFilter",{event:p,idx:e,column:l,item:t,firstColumn:a.columns[0]})},null,8,["theme","label","onClick"])):k("",!0)])):l.type==="Check"?(s(),r("div",me,[i(R,{type:"checkbox",modelValue:t,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):(s(),r("div",{key:3,class:"truncate text-base",onClick:p=>u("applyFilter",{event:p,idx:e,column:l,item:t,firstColumn:a.columns[0]})},F(w),9,ke))]),_:2},1032,["item","align"]))]),_:1},8,["rows"]),i(d(ee),null,{actions:c(({selections:e,unselectAll:l})=>[i(d(oe),{options:v.value.bulkActions(e,l)},{default:c(()=>[i(_,{icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"])]),_:1})]),_:1},8,["class","columns","rows","options"]),y.value?(s(),m(d(se),{key:0,class:"border-t sm:px-5 px-3 py-2",modelValue:y.value,"onUpdate:modelValue":o[3]||(o[3]=e=>y.value=e),options:{rowCount:a.options.rowCount,totalCount:a.options.totalCount},onLoadMore:o[4]||(o[4]=e=>u("loadMore"))},null,8,["modelValue","options"])):k("",!0),i(E,{ref_key:"listBulkActionsRef",ref:v,modelValue:C.value,"onUpdate:modelValue":o[5]||(o[5]=e=>C.value=e),doctype:"CRM Deal"},null,8,["modelValue"])],64)}}};export{Le as _};
//# sourceMappingURL=DealsListView-198dd0d4.js.map
