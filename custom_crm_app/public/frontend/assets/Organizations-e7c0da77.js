import{_ as q}from"./ViewBreadcrumbs-772e4ab3.js";import{_ as H}from"./CustomActions-051df89f.js";import{O as h}from"./OrganizationsIcon-188615d7.js";import{_ as j}from"./LayoutHeader-14d19c20.js";import{_ as E}from"./OrganizationModal-54ced291.js";import{L as W,W as J,M as T,x,X,y as Y,l as C,r as U,b as u,c as g,d as i,w as p,u as y,F as A,f as G,g as b,n as N,A as w,U as K,e as $,t as O,Y as Q}from"./index-a3e8239b.js";import{H as S,_ as Z}from"./ListBulkActions-ab2a2653.js";import{_ as ee}from"./DeleteLinkedDocModal-fb988008.js";import{L as te,a as oe,b as le,c as ae,d as se}from"./ListView-b8b2188c.js";import{a as ie,b as ne,f as I,w as ue,t as re}from"./index-98a0eb06.js";import{L as de}from"./ListFooter-af9aa9de.js";import{D as me}from"./dayjs-de744307.js";import{_ as pe}from"./ViewControls-7d016562.js";import"./Icon-c9812454.js";import"./DragVerticalIcon-cbd80dc8.js";import"./Link-ce253979.js";import"./FieldLayout-69566732.js";import"./modals-3c1f9e01.js";import"./global-f8b0dbce.js";import"../node_modules/frappe-ui/src/resources/listResource.js";import"./IndicatorIcon-6cac9012.js";import"./settings-c75a63ab.js";import"./plus-d2d9d364.js";import"./TabButtons-71b5ed70.js";import"./description-7db9d20b.js";import"./FadedScrollableDiv-143e35ae.js";import"./RefreshIcon-de37e5fb.js";import"./IconPicker-ae1e34a3.js";import"./PinIcon-7b40a90c.js";import"./DateRangePicker.vue_vue_type_script_setup_true_lang-d67000b7.js";import"./DetailsIcon-a948fc9a.js";import"./pageMeta-155cb5a4.js";const fe={key:0},ve=["onClick"],ye={key:1},ke={key:2},ge=["onClick"],Ce={__name:"OrganizationsListView",props:W({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:W(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(r,{expose:z,emit:F}){const f=F,V=J(),k=T(r,"modelValue"),s=T(r,"list"),_=x(()=>{var n,o;return!!((o=(n=s.value.params)==null?void 0:n.filters)!=null&&o._liked_by)}),{user:M}=X();function L(n){if(n)return JSON.parse(n).includes(M)}Y(k,(n,o)=>{n!==o&&f("updatePageCount",n)});const v=C(null);return z({customListActions:x(()=>{var n;return(n=v.value)==null?void 0:n.customListActions})}),(n,o)=>{const t=U("Button"),c=U("FormControl");return u(),g(A,null,[i(y(se),{columns:r.columns,rows:r.rows,options:{getRowRoute:e=>({name:"Organization",params:{organizationId:e.name},query:{view:y(V).query.view,viewType:y(V).params.viewType}}),selectable:r.options.selectable,showTooltip:r.options.showTooltip,resizeColumn:r.options.resizeColumn},"row-key":"name","onUpdate:selections":o[2]||(o[2]=e=>f("selectionsChanged",e))},{default:p(()=>[i(y(te),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:o[1]||(o[1]=e=>f("columnWidthUpdated"))},{default:p(()=>[(u(!0),g(A,null,G(r.columns,e=>(u(),b(y(oe),{key:e.key,item:e,onColumnWidthUpdated:l=>f("columnWidthUpdated",e)},{default:p(()=>[e.key=="_liked_by"?(u(),b(t,{key:0,variant:"ghosted",class:N(["!h-4",_.value?"fill-red-500":"fill-white"]),onClick:o[0]||(o[0]=()=>f("applyLikeFilter"))},{default:p(()=>[i(S,{class:"h-4 w-4"})]),_:1},8,["class"])):w("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),i(ee,{class:"mx-3 sm:mx-5",rows:r.rows,doctype:"CRM Organization"},{default:p(({idx:e,column:l,item:d})=>[i(y(le),{item:d,align:l.align},{prefix:p(()=>[l.key==="organization_name"?(u(),g("div",fe,[d.label?(u(),b(y(ie),{key:0,class:"flex items-center",image:d.logo,label:d.label,size:"sm"},null,8,["image","label"])):w("",!0)])):w("",!0)]),default:p(({label:a})=>[["modified","creation"].includes(l.key)?(u(),g("div",{key:0,class:"truncate text-base",onClick:m=>f("applyFilter",{event:m,idx:e,column:l,item:d,firstColumn:r.columns[0]})},[i(y(K),{text:d.label},{default:p(()=>[$("div",null,O(d.timeAgo),1)]),_:2},1032,["text"])],8,ve)):l.type==="Check"?(u(),g("div",ye,[i(c,{type:"checkbox",modelValue:d,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):l.key==="_liked_by"?(u(),g("div",ke,[l.key=="_liked_by"?(u(),b(t,{key:0,variant:"ghosted",class:N(L(d)?"fill-red-500":"fill-white"),onClick:Q(()=>f("likeDoc",{name:n.row.name,liked:L(d)}),["stop","prevent"])},{default:p(()=>[i(S,{class:"h-4 w-4"})]),_:1},8,["class","onClick"])):w("",!0)])):(u(),g("div",{key:3,class:"truncate text-base",onClick:m=>f("applyFilter",{event:m,idx:e,column:l,item:d,firstColumn:r.columns[0]})},O(a),9,ge))]),_:2},1032,["item","align"])]),_:1},8,["rows"]),i(y(ae),null,{actions:p(({selections:e,unselectAll:l})=>[i(y(me),{options:v.value.bulkActions(e,l)},{default:p(()=>[i(t,{icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"])]),_:1})]),_:1},8,["columns","rows","options"]),i(y(de),{class:"border-t sm:px-5 px-3 py-2",modelValue:k.value,"onUpdate:modelValue":o[3]||(o[3]=e=>k.value=e),options:{rowCount:r.options.rowCount,totalCount:r.options.totalCount},onLoadMore:o[4]||(o[4]=e=>f("loadMore"))},null,8,["modelValue","options"]),i(Z,{ref_key:"listBulkActionsRef",ref:v,modelValue:s.value,"onUpdate:modelValue":o[5]||(o[5]=e=>s.value=e),doctype:"CRM Organization",options:{hideAssign:!0}},null,8,["modelValue"])],64)}}},ce={key:1,class:"flex h-full items-center justify-center"},be={class:"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4"},Ze={__name:"Organizations",setup(r){const{getFormattedPercent:z,getFormattedFloat:F,getFormattedCurrency:f}=ne("CRM Organization"),V=C(null),k=C(!1),s=C({}),_=C(1),M=C(1),L=C(20),v=C(null),n=x(()=>{var o,t,c;return!((t=(o=s.value)==null?void 0:o.data)!=null&&t.data)||!["list","group_by"].includes(s.value.data.view_type)?[]:(c=s.value)==null?void 0:c.data.data.map(e=>{var d;let l={};return(d=s.value)==null||d.data.rows.forEach(a=>{var B,D,R;l[a]=e[a];let m=(R=(D=(B=s.value)==null?void 0:B.data.columns)==null?void 0:D.find(P=>(P.key||P.value)==a))==null?void 0:R.type;m&&["Date","Datetime"].includes(m)&&!["modified","creation"].includes(a)&&(l[a]=I(e[a],"",!0,m=="Datetime")),m&&m=="Currency"&&(l[a]=f(a,e)),m&&m=="Float"&&(l[a]=F(a,e)),m&&m=="Percent"&&(l[a]=z(a,e)),a==="organization_name"?l[a]={label:e.organization_name,logo:e.organization_logo}:a==="website"?l[a]=ue(e.website):["modified","creation"].includes(a)&&(l[a]={label:I(e[a]),timeAgo:__(re(e[a]))})}),l})});return(o,t)=>{const c=U("Button");return u(),g(A,null,[i(j,null,{"left-header":p(()=>[i(q,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value=e),routeName:"Organizations"},null,8,["modelValue"])]),"right-header":p(()=>{var e;return[(e=V.value)!=null&&e.customListActions?(u(),b(H,{key:0,actions:V.value.customListActions},null,8,["actions"])):w("",!0),i(c,{variant:"solid",label:o.__("Create"),iconLeft:"plus",onClick:t[1]||(t[1]=l=>k.value=!0)},null,8,["label"])]}),_:1}),i(pe,{ref_key:"viewControls",ref:v,modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=e=>s.value=e),loadMore:_.value,"onUpdate:loadMore":t[3]||(t[3]=e=>_.value=e),resizeColumn:M.value,"onUpdate:resizeColumn":t[4]||(t[4]=e=>M.value=e),updatedPageCount:L.value,"onUpdate:updatedPageCount":t[5]||(t[5]=e=>L.value=e),doctype:"CRM Organization"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),s.value.data&&n.value.length?(u(),b(Ce,{key:0,ref_key:"organizationsListView",ref:V,modelValue:s.value.data.page_length_count,"onUpdate:modelValue":t[6]||(t[6]=e=>s.value.data.page_length_count=e),list:s.value,"onUpdate:list":t[7]||(t[7]=e=>s.value=e),rows:n.value,columns:s.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:s.value.data.row_count,totalCount:s.value.data.total_count},onLoadMore:t[8]||(t[8]=()=>_.value++),onColumnWidthUpdated:t[9]||(t[9]=()=>M.value++),onUpdatePageCount:t[10]||(t[10]=e=>L.value=e),onApplyFilter:t[11]||(t[11]=e=>v.value.applyFilter(e)),onApplyLikeFilter:t[12]||(t[12]=e=>v.value.applyLikeFilter(e)),onLikeDoc:t[13]||(t[13]=e=>v.value.likeDoc(e)),onSelectionsChanged:t[14]||(t[14]=e=>v.value.updateSelections(e))},null,8,["modelValue","list","rows","columns","options"])):s.value.data?(u(),g("div",ce,[$("div",be,[i(h,{class:"h-10 w-10"}),$("span",null,O(o.__("No {0} Found",[o.__("Organizations")])),1),i(c,{label:o.__("Create"),iconLeft:"plus",onClick:t[15]||(t[15]=e=>k.value=!0)},null,8,["label"])])])):w("",!0),k.value?(u(),b(E,{key:2,modelValue:k.value,"onUpdate:modelValue":t[16]||(t[16]=e=>k.value=e)},null,8,["modelValue"])):w("",!0)],64)}}};export{Ze as default};
//# sourceMappingURL=Organizations-e7c0da77.js.map
