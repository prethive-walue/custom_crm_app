import{j as Ce,H as be,l as p,x as z,y as X,b as f,g as Ve,w,z as K,d as x,ag as we,O as N,P as U,a7 as Re,Y as Z,n as Y,aK as Se,u as g,aU as $e,e as b,c as d,t as h,a8 as R,F as S,f as $,A as De,ad as Me}from"./index-a3e8239b.js";import{d as v,a as Te}from"./dayjs-de744307.js";import{g as Be,m as P,b as j,c as ze}from"./Link-ce253979.js";const Ye={class:"flex items-center justify-between p-2 pb-0 gap-1"},Ee={key:0},Fe={key:1},Ae={key:2},Ie={class:"flex items-center"},Le={class:"p-2"},Ke={key:0},Ne={class:"flex items-center text-xs font-medium uppercase text-ink-gray-4 mb-1"},Ue=["aria-selected","aria-label","onClick"],We={key:1,class:"grid grid-cols-3 gap-1",role:"grid","aria-label":"Select month"},He=["aria-selected","onClick"],qe={key:2,class:"grid grid-cols-3 gap-1",role:"grid","aria-label":"Select year"},Ge=["aria-selected","onClick"],Je={key:0,class:"flex justify-end gap-1 p-2 border-t"},k="YYYY-MM-DD",Pe=Ce({__name:"DateRangePicker",props:{value:{default:""},modelValue:{default:""},placement:{default:"bottom-start"},format:{},variant:{default:"subtle"},readonly:{type:Boolean,default:!1},placeholder:{default:"Select range"},inputClass:{},allowCustom:{type:Boolean,default:!0},autoClose:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},label:{},clearable:{type:Boolean}},emits:["update:modelValue","change"],setup(O,{expose:ee,emit:ae}){const r=O,D=ae,{autoClose:E}=be(r),i=p("date"),c=p(v().year()),m=p(v().month()),u=p(""),o=p(""),y=p(!1),_=p("");function te(e,a){return!e&&!a?"":e&&!a?F(e):`${F(e)} to ${F(a)}`}function F(e){if(!e)return"";const a=v(e);return a.isValid()&&r.format?a.format(r.format):e}const V=z(()=>te(u.value,o.value));function M(e){if(!e)return null;const a=String(e).trim();if(!a)return null;if(r.format){const l=v(a,r.format,!0);if(l.isValid())return l}const t=v(a);if(t.isValid())return t;const n=ze(a);if(n){const l=v(n);if(l.isValid())return l}return null}function ne(e){if(!e)return["",""];let a=[];Array.isArray(e)?a=e:typeof e=="string"&&(a=e.replace(/ to /i,",").replace(/ - /g,",").split(",").map(s=>s.trim()).filter(Boolean));const t=M(a[0]||""),n=M(a[1]||"");return[(t==null?void 0:t.format(k))||"",(n==null?void 0:n.format(k))||""]}function A(e){const[a,t]=ne(e);if(u.value=a,o.value=t,a){const n=v(a);c.value=n.year(),m.value=n.month()}y.value||C()}const le=r.modelValue||r.value||"";A(le);function se(){A(r.modelValue||r.value||"")}X(()=>[r.modelValue,r.value],([e,a])=>{A(e||a)});function C(){_.value=V.value}C(),X(V,e=>{y.value||(_.value=e)});function oe(e){if(!e.trim())return[null,null];const t=e.replace(/\s+to\s+/i,",").replace(/\s+-\s+/g,",").split(",").map(s=>s.trim()).filter(Boolean);if(!t.length)return[null,null];const n=M(t[0]),l=M(t[1]);return[n,l]}function T(e,a=!0){a&&E.value&&e&&e()}function I(e=!1,a){const t=_.value.trim();if(!t){G(),T(a,e);return}const[n,l]=oe(t);n&&(u.value=n.format(k)),l&&(o.value=l.format(k)),l||(o.value=""),q(),B(),C(),T(a,e&&!!u.value&&!!o.value)}const W=p(null);function ue(e){var t;const a=e.relatedTarget;a&&((t=W.value)!=null&&t.contains(a))||(I(),y.value=!1)}function re(e){I(!0,e),y.value=!1}function H(e,a){y.value=!0,e||a()}const ie=z(()=>{const e=Be(c.value,m.value,""),a=v(u.value),t=v(o.value);return e.map(n=>n.map(l=>{const s=a.isValid()&&l.date.isSame(a,"day"),Q=t.isValid()&&l.date.isSame(t,"day"),xe=a.isValid()&&t.isValid()&&l.date.isAfter(a,"day")&&l.date.isBefore(t,"day");return{date:l.date,key:l.key,inMonth:l.inMonth,isToday:l.isToday,isRangeStart:s,isRangeEnd:Q,inRange:xe}}))});function ce(e){const a=v(e);a.isValid()&&(u.value&&o.value?(u.value=a.format(k),o.value=""):u.value&&!o.value?o.value=a.format(k):u.value=a.format(k),q(),C())}function q(){if(u.value&&o.value&&v(u.value).isAfter(v(o.value))){const e=u.value;u.value=o.value,o.value=e}}function fe(e,a){ce(e),E.value&&u.value&&o.value&&(B(),T(a,!0)),y.value=!1}function B(){if(u.value&&o.value){const e=`${u.value},${o.value}`;D("update:modelValue",e),D("change",e)}!u.value&&!o.value&&(D("update:modelValue",""),D("change",""))}function G(){u.value="",o.value="",B(),C()}function de(e){G(),T(e),y.value=!1,i.value="date"}function ve(e){const a=Te().startOf("day");u.value=a.format(k),o.value=a.format(k),B(),C(),E.value&&e&&e(),i.value="date",y.value=!1}function me(e){m.value=e,i.value="date"}function ye(e){c.value=e,i.value="month"}function pe(){if(i.value==="date"){const e=j(c.value,m.value).subtract(1,"month");c.value=e.year(),m.value=e.month()}else i.value==="month"?c.value-=1:c.value-=12}function ge(){if(i.value==="date"){const e=j(c.value,m.value).add(1,"month");c.value=e.year(),m.value=e.month()}else i.value==="month"?c.value+=1:c.value+=12}function he(){i.value==="date"?i.value="month":i.value==="month"?i.value="year":i.value="date"}function ke(){i.value="date",y.value&&(I(),y.value=!1)}const L=z(()=>c.value-c.value%12),_e=z(()=>Array.from({length:12},(e,a)=>L.value+a));ee({open:()=>{var e;return(e=J.value)==null?void 0:e.open()}});const J=p(null);return(e,a)=>(f(),Ve(g(Me),{class:"inline-block",placement:e.placement,onOpen:se,onClose:ke,ref_key:"popoverRef",ref:J},{target:w(({togglePopover:t,isOpen:n})=>[K(e.$slots,"target",N(U({togglePopover:t,isOpen:n,displayLabel:V.value,inputValue:_.value})),()=>[x(g($e),{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=l=>_.value=l),type:"text",class:Y(["cursor-text w-full",r.inputClass]),label:r.label,variant:r.variant,placeholder:r.placeholder,disabled:r.disabled,readonly:r.readonly||!r.allowCustom,onFocus:l=>H(n,t),onClick:l=>H(n,t),onBlur:ue,onKeydown:Se(Z(l=>re(t),["prevent"]),["enter"])},we({suffix:w(()=>[K(e.$slots,"suffix",N(U({togglePopover:t,isOpen:n,displayLabel:V.value,inputValue:_.value})),()=>[x(Re,{name:"chevron-down",class:"h-4 w-4 cursor-pointer",onMousedown:Z(t,["prevent"])},null,8,["onMousedown"])])]),_:2},[e.$slots.prefix?{name:"prefix",fn:w(()=>[K(e.$slots,"prefix",N(U({togglePopover:t,isOpen:n,displayLabel:V.value,inputValue:_.value})))]),key:"0"}:void 0]),1032,["modelValue","class","label","variant","placeholder","disabled","readonly","onFocus","onClick","onKeydown"])])]),body:w(({togglePopover:t})=>[b("div",{ref_key:"popoverContentRef",ref:W,class:"w-fit min-w-60 select-none text-base text-ink-gray-9 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 mt-2"},[b("div",Ye,[x(g(R),{variant:"ghost",size:"sm",class:"text-sm font-medium text-ink-gray-7",onClick:he},{default:w(()=>[i.value==="date"?(f(),d("span",Ee,h(g(P)[m.value])+" "+h(c.value),1)):i.value==="month"?(f(),d("span",Fe,h(c.value),1)):(f(),d("span",Ae,h(L.value)+" - "+h(L.value+11),1))]),_:1}),b("div",Ie,[x(g(R),{variant:"ghost",icon:"chevron-left",class:"size-7",onClick:pe}),x(g(R),{variant:"ghost",class:"text-xs",label:"Today",onClick:()=>ve(t)},null,8,["onClick"]),x(g(R),{variant:"ghost",icon:"chevron-right",class:"size-7",onClick:ge})])]),b("div",Le,[i.value==="date"?(f(),d("div",Ke,[b("div",Ne,[(f(),d(S,null,$(["S","M","T","W","T","F","S"],n=>b("div",{key:n,class:"flex h-6 w-8 items-center justify-center"},h(n),1)),64))]),(f(!0),d(S,null,$(ie.value,(n,l)=>(f(),d("div",{key:l,class:"flex",role:"row"},[(f(!0),d(S,null,$(n,s=>(f(),d("button",{type:"button",key:s.key,class:Y(["flex h-8 w-8 items-center justify-center rounded cursor-pointer text-sm focus:outline-none focus:ring-2 focus:ring-outline-gray-2",[s.inMonth?"text-ink-gray-8":"text-ink-gray-3",s.isToday?"font-extrabold text-ink-gray-9":"",s.isRangeStart||s.isRangeEnd?"bg-surface-gray-6 text-ink-white hover:bg-surface-gray-6":s.inRange?"bg-surface-gray-3 rounded-none":"hover:bg-surface-gray-2",s.isRangeStart&&!s.isRangeEnd?"rounded-l-md rounded-r-none":"",s.isRangeEnd&&!s.isRangeStart?"rounded-r-md rounded-l-none":"",s.isRangeStart&&s.isRangeEnd?"rounded-md":""]]),role:"gridcell","aria-selected":s.isRangeStart||s.isRangeEnd?"true":"false","aria-label":s.date.format("YYYY-MM-DD")+(s.isToday?" (Today)":""),onClick:Q=>fe(s.date,t)},h(s.date.date()),11,Ue))),128))]))),128))])):i.value==="month"?(f(),d("div",We,[(f(!0),d(S,null,$(g(P),(n,l)=>(f(),d("button",{type:"button",key:n,class:Y(["py-2 text-sm rounded cursor-pointer text-center hover:bg-surface-gray-2 focus:outline-none focus:ring-2 focus:ring-brand-6",{"bg-surface-gray-6 text-ink-white hover:bg-surface-gray-6":l===m.value}]),"aria-selected":l===m.value?"true":"false",onClick:s=>me(l)},h(n.slice(0,3)),11,He))),128))])):(f(),d("div",qe,[(f(!0),d(S,null,$(_e.value,n=>(f(),d("button",{type:"button",key:n,class:Y(["py-2 text-sm rounded cursor-pointer text-center hover:bg-surface-gray-2 focus:outline-none focus:ring-2 focus:ring-brand-6",{"bg-surface-gray-6 text-ink-white hover:bg-surface-gray-6":n===c.value}]),"aria-selected":n===c.value?"true":"false",onClick:l=>ye(n)},h(n),11,Ge))),128))]))]),u.value&&o.value?(f(),d("div",Je,[x(g(R),{size:"sm",variant:"outline",label:"Clear",onClick:()=>de(t)},null,8,["onClick"])])):De("",!0)],512)]),_:3},8,["placement"]))}});export{Pe as _};
//# sourceMappingURL=DateRangePicker.vue_vue_type_script_setup_true_lang-d67000b7.js.map
