import{_ as N}from"./ViewBreadcrumbs-772e4ab3.js";import{_ as W}from"./CustomActions-051df89f.js";import{P as T}from"./PhoneIcon-58ab8bcd.js";import{_ as H}from"./LayoutHeader-14d19c20.js";import{_ as E}from"./ViewControls-7d016562.js";import{L as R,M as D,x as $,X as j,y as q,l as c,r as h,b as r,c as p,d as n,w as m,u as v,F as A,f as O,g as w,n as S,A as V,U as J,e as B,t as z,Y as X,I as Y,a as G,T as K}from"./index-a3e8239b.js";import{H as I,_ as Q}from"./ListBulkActions-ab2a2653.js";import{_ as Z}from"./DeleteLinkedDocModal-fb988008.js";import{L as ee,a as oe,b as le,c as te,d as ae}from"./ListView-b8b2188c.js";import{a as se}from"./index-98a0eb06.js";import{L as ne}from"./ListFooter-af9aa9de.js";import{D as ie}from"./dayjs-de744307.js";import{C as re,_ as ue,g as de}from"./CallLogModal-6ea74f2a.js";import"./Icon-c9812454.js";import"./DragVerticalIcon-cbd80dc8.js";import"./Link-ce253979.js";import"./FadedScrollableDiv-143e35ae.js";import"./RefreshIcon-de37e5fb.js";import"./IconPicker-ae1e34a3.js";import"./PinIcon-7b40a90c.js";import"./DateRangePicker.vue_vue_type_script_setup_true_lang-d67000b7.js";import"./DetailsIcon-a948fc9a.js";import"./settings-c75a63ab.js";import"./plus-d2d9d364.js";import"./global-f8b0dbce.js";import"./pageMeta-155cb5a4.js";import"../node_modules/frappe-ui/src/resources/listResource.js";import"./TabButtons-71b5ed70.js";import"./description-7db9d20b.js";import"./ArrowUpRightIcon-afcc694f.js";import"./ContactsIcon-506159cf.js";import"./LeadsIcon-0c50d745.js";import"./DealsIcon-f2e9236f.js";import"./CalendarIcon-ddedd640.js";import"./NoteModal-ca2fb0bc.js";import"./onboarding-47f442cf.js";import"./TaskIcon-cff875a2.js";import"./TaskModal-957b3e05.js";import"./modals-3c1f9e01.js";import"./FieldLayout-69566732.js";import"./IndicatorIcon-6cac9012.js";const me={key:0},pe={key:1},ce=["onClick"],fe={key:1,class:"truncate text-base"},ve={key:2},ge={key:3},Ce=["onClick"],ke={__name:"CallLogsListView",props:R({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:R(["showCallLog","loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(u,{expose:_,emit:g}){const l=g,k=D(u,"modelValue"),y=D(u,"list"),b=$(()=>{var a,s;return!!((s=(a=y.value.params)==null?void 0:a.filters)!=null&&s._liked_by)}),{user:f}=j();function M(a){if(a)return JSON.parse(a).includes(f)}q(k,(a,s)=>{a!==s&&l("updatePageCount",a)});const L=c(null);return _({customListActions:$(()=>{var a;return(a=L.value)==null?void 0:a.customListActions})}),(a,s)=>{const U=h("Button"),x=h("FeatherIcon"),d=h("Badge"),o=h("FormControl");return r(),p(A,null,[n(v(ae),Y({columns:u.columns,rows:u.rows,options:{onRowClick:t=>l("showCallLog",t.name),selectable:u.options.selectable,showTooltip:u.options.showTooltip,resizeColumn:u.options.resizeColumn},"row-key":"name"},a.$attrs,{"onUpdate:selections":s[2]||(s[2]=t=>l("selectionsChanged",t))}),{default:m(()=>[n(v(ee),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:s[1]||(s[1]=t=>l("columnWidthUpdated"))},{default:m(()=>[(r(!0),p(A,null,O(u.columns,t=>(r(),w(v(oe),{key:t.key,item:t,onColumnWidthUpdated:e=>l("columnWidthUpdated",t)},{default:m(()=>[t.key=="_liked_by"?(r(),w(U,{key:0,variant:"ghosted",class:S(["!h-4",b.value?"fill-red-500":"fill-white"]),onClick:s[0]||(s[0]=()=>l("applyLikeFilter"))},{default:m(()=>[n(I,{class:"h-4 w-4"})]),_:1},8,["class"])):V("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),n(Z,{class:"mx-3 sm:mx-5",rows:u.rows,doctype:"CRM Call Log"},{default:m(({idx:t,column:e,item:i})=>[n(v(le),{item:i,align:e.align},{prefix:m(()=>[["caller","receiver"].includes(e.key)?(r(),p("div",me,[i.label?(r(),w(v(se),{key:0,class:"flex items-center",image:i.image,label:i.label,size:"sm"},null,8,["image","label"])):V("",!0)])):["type","duration"].includes(e.key)?(r(),p("div",pe,[n(x,{name:i.icon,class:"h-3 w-3"},null,8,["name"])])):V("",!0)]),default:m(({label:F})=>[["modified","creation"].includes(e.key)?(r(),p("div",{key:0,class:"truncate text-base",onClick:C=>l("applyFilter",{event:C,idx:t,column:e,item:i,firstColumn:u.columns[0]})},[n(v(J),{text:i.label},{default:m(()=>[B("div",null,z(i.timeAgo),1)]),_:2},1032,["text"])],8,ce)):e.key==="status"?(r(),p("div",fe,[n(d,{variant:"subtle",theme:i.color,size:"md",label:a.__(i.label),onClick:C=>l("applyFilter",{event:C,idx:t,column:e,item:i,firstColumn:u.columns[0]})},null,8,["theme","label","onClick"])])):e.type==="Check"?(r(),p("div",ve,[n(o,{type:"checkbox",modelValue:i,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):e.key==="_liked_by"?(r(),p("div",ge,[e.key=="_liked_by"?(r(),w(U,{key:0,variant:"ghosted",class:S(M(i)?"fill-red-500":"fill-white"),onClick:X(()=>l("likeDoc",{name:a.row.name,liked:M(i)}),["stop","prevent"])},{default:m(()=>[n(I,{class:"h-4 w-4"})]),_:1},8,["class","onClick"])):V("",!0)])):(r(),p("div",{key:4,class:"truncate text-base",onClick:C=>l("applyFilter",{event:C,idx:t,column:e,item:i,firstColumn:u.columns[0]})},z(F),9,Ce))]),_:2},1032,["item","align"])]),_:1},8,["rows"]),n(v(te),null,{actions:m(({selections:t,unselectAll:e})=>[n(v(ie),{options:L.value.bulkActions(t,e)},{default:m(()=>[n(U,{icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"])]),_:1})]),_:1},16,["columns","rows","options"]),n(v(ne),{class:"border-t sm:px-5 px-3 py-2",modelValue:k.value,"onUpdate:modelValue":s[3]||(s[3]=t=>k.value=t),options:{rowCount:u.options.rowCount,totalCount:u.options.totalCount},onLoadMore:s[4]||(s[4]=t=>l("loadMore"))},null,8,["modelValue","options"]),n(Q,{ref_key:"listBulkActionsRef",ref:L,modelValue:y.value,"onUpdate:modelValue":s[5]||(s[5]=t=>y.value=t),doctype:"CRM Call Log",options:{hideEdit:!0,hideAssign:!0}},null,8,["modelValue"])],64)}}},ye={key:1,class:"flex h-full items-center justify-center"},Le={class:"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4"},ro={__name:"CallLogs",setup(u){const _=c(null),g=c(!1),l=c({}),k=c(1),y=c(1),b=c(20),f=c(null),M=$(()=>{var d,o,t;return!((o=(d=l.value)==null?void 0:d.data)!=null&&o.data)||!["list","group_by"].includes(l.value.data.view_type)?[]:(t=l.value)==null?void 0:t.data.data.map(e=>{var F;let i={};return(F=l.value)==null||F.data.rows.forEach(C=>{var P;i[C]=de(C,e,(P=l.value)==null?void 0:P.data.columns)}),i})}),L=c(!1),a=c({});function s(d){L.value=!0,a.value=K({url:"crm.fcrm.doctype.crm_call_log.crm_call_log.get_call_log",params:{name:d},cache:["call_log",d],auto:!0})}function U(){a.value={},g.value=!0}const x=()=>{const d=new URLSearchParams(window.location.search),o=d.get("open");o&&(s(o),d.delete("open"),window.history.replaceState(null,"",window.location.pathname))};return G(()=>{x()}),(d,o)=>{const t=h("Button");return r(),p(A,null,[n(H,null,{"left-header":m(()=>[n(N,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=e=>f.value=e),routeName:"Call Logs"},null,8,["modelValue"])]),"right-header":m(()=>{var e;return[(e=_.value)!=null&&e.customListActions?(r(),w(W,{key:0,actions:_.value.customListActions},null,8,["actions"])):V("",!0),n(t,{variant:"solid",label:d.__("Create"),iconLeft:"plus",onClick:U},null,8,["label"])]}),_:1}),n(E,{ref_key:"viewControls",ref:f,modelValue:l.value,"onUpdate:modelValue":o[1]||(o[1]=e=>l.value=e),loadMore:k.value,"onUpdate:loadMore":o[2]||(o[2]=e=>k.value=e),resizeColumn:y.value,"onUpdate:resizeColumn":o[3]||(o[3]=e=>y.value=e),updatedPageCount:b.value,"onUpdate:updatedPageCount":o[4]||(o[4]=e=>b.value=e),doctype:"CRM Call Log"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),l.value.data&&M.value.length?(r(),w(ke,{key:0,ref_key:"callLogsListView",ref:_,modelValue:l.value.data.page_length_count,"onUpdate:modelValue":o[5]||(o[5]=e=>l.value.data.page_length_count=e),list:l.value,"onUpdate:list":o[6]||(o[6]=e=>l.value=e),rows:M.value,columns:l.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:l.value.data.row_count,totalCount:l.value.data.total_count},onShowCallLog:s,onLoadMore:o[7]||(o[7]=()=>k.value++),onColumnWidthUpdated:o[8]||(o[8]=()=>y.value++),onUpdatePageCount:o[9]||(o[9]=e=>b.value=e),onApplyFilter:o[10]||(o[10]=e=>f.value.applyFilter(e)),onApplyLikeFilter:o[11]||(o[11]=e=>f.value.applyLikeFilter(e)),onLikeDoc:o[12]||(o[12]=e=>f.value.likeDoc(e)),onSelectionsChanged:o[13]||(o[13]=e=>f.value.updateSelections(e))},null,8,["modelValue","list","rows","columns","options"])):l.value.data?(r(),p("div",ye,[B("div",Le,[n(T,{class:"h-10 w-10"}),B("span",null,z(d.__("No {0} Found",[d.__("Logs")])),1)])])):V("",!0),n(re,{modelValue:L.value,"onUpdate:modelValue":o[14]||(o[14]=e=>L.value=e),callLogModal:g.value,"onUpdate:callLogModal":o[15]||(o[15]=e=>g.value=e),callLog:a.value,"onUpdate:callLog":o[16]||(o[16]=e=>a.value=e)},null,8,["modelValue","callLogModal","callLog"]),g.value?(r(),w(ue,{key:2,modelValue:g.value,"onUpdate:modelValue":o[17]||(o[17]=e=>g.value=e),data:a.value.data,options:{afterInsert:()=>l.value.reload()}},null,8,["modelValue","data","options"])):V("",!0)],64)}}};export{ro as default};
//# sourceMappingURL=CallLogs-05560614.js.map
