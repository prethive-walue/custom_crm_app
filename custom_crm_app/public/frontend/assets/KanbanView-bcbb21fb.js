import{L as V,M as Y,x as b,r as q,b as r,c as u,g as x,w as c,e as n,d as s,n as B,u as m,F as z,f as E,ad as G,t as k,a2 as H,I as L,z as y,O as R,P as j,A as g,Y as J}from"./index-a3e8239b.js";import{a as Q}from"./Link-ce253979.js";import{I as F}from"./IndicatorIcon-6cac9012.js";import{u as C,x as I,y as P}from"./index-98a0eb06.js";import{D as A}from"./DragVerticalIcon-cbd80dc8.js";import{D as U}from"./dayjs-de744307.js";const W={class:"flex overflow-x-auto h-full"},X={key:0,class:"flex flex-col gap-2.5 min-w-72 w-72 hover:bg-surface-gray-2 rounded-lg p-2.5"},Z={class:"flex gap-2 items-center group justify-between"},ee={class:"flex items-center text-base"},te={class:"flex flex-col gap-3 px-3 py-2.5 min-w-40 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none"},le={class:"flex gap-1"},oe={class:"flex flex-row-reverse"},ae={class:"text-ink-gray-9"},ne={class:"flex"},se={class:"overflow-y-auto flex flex-col gap-2 h-full"},ie={class:"h-5 flex items-center"},re={key:0},ue={key:1,class:"text-ink-gray-4"},ce={class:"flex flex-col gap-3.5"},me={key:0,class:"truncate"},de={class:"flex gap-2 items-center justify-between"},fe={key:0,class:"flex items-center justify-center"},pe={key:1,class:"shrink-0 min-w-64"},xe={__name:"KanbanView",props:V({options:{type:Object,default:()=>({getRoute:null,onClick:null,onNewClick:null})}},{modelValue:{},modelModifiers:{}}),emits:V(["update","loadMore"],["update:modelValue"]),setup(d,{emit:O}){const w=O,_=Y(d,"modelValue"),h=b(()=>{var e,o;return(o=(e=_.value)==null?void 0:e.data)==null?void 0:o.title_field}),f=b(()=>{var a,l;if(!((l=(a=_.value)==null?void 0:a.data)!=null&&l.data)||_.value.data.view_type!="kanban")return[];let e=_.value.data.data;return e.some(t=>{var i;return(i=t.column)==null?void 0:i.color})||e.forEach((t,i)=>{t.column.color=C[i%C.length]}),e}),N=b(()=>f.value.filter(e=>e.column.delete).map(e=>({label:e.column.name,value:e.column.name})));function S(e){return[{group:__("Options"),hideLabel:!0,items:[{label:__("Delete"),icon:"trash-2",onClick:()=>{e.column.delete=!0,p()}}]}]}function T(e){let o=f.value.find(a=>a.column.name==e.value);o.column.delete=!1,p()}function p(e){var D,M,$;let o=(D=e==null?void 0:e.to)==null?void 0:D.dataset.column,a=(M=e==null?void 0:e.from)==null?void 0:M.dataset.column,l=($=e==null?void 0:e.item)==null?void 0:$.dataset.name,t=[];f.value.forEach(v=>{v.column.order=v.data.map(K=>K.name),v.column.page_length&&delete v.column.page_length,t.push(v.column)});let i={kanban_columns:t};o!=a&&(i={item:l,to:o,kanban_columns:t}),w("update",i)}return(e,o)=>{const a=q("Button");return r(),u("div",W,[f.value?(r(),x(m(A),{key:0,list:f.value,"item-key":"column",onEnd:p,delay:m(P)()?200:0,class:"flex sm:mx-2.5 mx-2 pb-3.5"},{item:c(({element:l})=>[l.column.delete?g("",!0):(r(),u("div",X,[n("div",Z,[n("div",ee,[s(m(G),null,{target:c(({togglePopover:t})=>[s(a,{variant:"ghost",size:"sm",class:"hover:!bg-surface-gray-2",onClick:t},{default:c(()=>[s(F,{class:B(m(I)(l.column.color))},null,8,["class"])]),_:2},1032,["onClick"])]),body:c(()=>[n("div",te,[n("div",le,[(r(!0),u(z,null,E(m(C),t=>(r(),x(a,{variant:"ghost",key:t,onClick:()=>l.column.color=t},{default:c(()=>[s(F,{class:B(m(I)(t))},null,8,["class"])]),_:2},1032,["onClick"]))),128))]),n("div",oe,[s(a,{variant:"solid",label:e.__("Apply"),onClick:p},null,8,["label"])])])]),_:2},1024),n("div",ae,k(l.column.name),1)]),n("div",ne,[s(m(U),{options:S(l)},{default:c(()=>[s(a,{class:"hidden group-hover:flex",icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"]),s(a,{icon:"plus",variant:"ghost",onClick:t=>d.options.onNewClick(l)},null,8,["onClick"])])]),n("div",se,[s(m(A),{list:l.data,group:"fields","item-key":"name",class:"flex flex-col gap-3.5 flex-1",onEnd:p,delay:m(P)()?200:0,"data-column":l.column.name},{item:c(({element:t})=>[(r(),x(H(d.options.getRoute?"router-link":"div"),L({class:"pt-3 px-3.5 pb-2.5 rounded-lg border bg-surface-white text-base flex flex-col text-ink-gray-9","data-name":t.name},{to:d.options.getRoute?d.options.getRoute(t):void 0,onClick:d.options.onClick?()=>d.options.onClick(t):void 0}),{default:c(()=>[y(e.$slots,"title",R(j({fields:t,titleField:h.value,itemName:t.name})),()=>[n("div",ie,[t[h.value]?(r(),u("div",re,k(t[h.value]),1)):(r(),u("div",ue,k(e.__("No Title")),1))])]),o[3]||(o[3]=n("div",{class:"border-b h-px my-2.5"},null,-1)),n("div",ce,[(r(!0),u(z,null,E(l.fields,i=>y(e.$slots,"fields",L({key:i,ref_for:!0},{fields:t,fieldName:i,itemName:t.name}),()=>[t[i]?(r(),u("div",me,k(t[i]),1)):g("",!0)])),128))]),o[4]||(o[4]=n("div",{class:"border-b h-px mt-2.5 mb-2"},null,-1)),y(e.$slots,"actions",R(j({itemName:t.name})),()=>[n("div",de,[o[2]||(o[2]=n("div",null,null,-1)),s(a,{icon:"plus",variant:"ghost",onClick:o[0]||(o[0]=J(()=>{},["stop","prevent"]))})])])]),_:2},1040,["data-name"]))]),_:2},1032,["list","delay","data-column"]),l.column.count<l.column.all_count?(r(),u("div",fe,[s(a,{label:e.__("Load More"),onClick:t=>w("loadMore",l.column.name)},null,8,["label","onClick"])])):g("",!0)])]))]),_:3},8,["list","delay"])):g("",!0),N.value.length?(r(),u("div",pe,[s(Q,{value:"",options:N.value,onChange:o[1]||(o[1]=l=>T(l))},{target:c(({togglePopover:l})=>[s(a,{class:"w-full mt-2.5 mb-1 mr-5",label:e.__("Add Column"),iconLeft:"plus",onClick:t=>l()},null,8,["label","onClick"])]),_:1},8,["options"])])):g("",!0)])}}};export{xe as _};
//# sourceMappingURL=KanbanView-bcbb21fb.js.map
